"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[135],{76:(x,g,o)=>{o.d(g,{S:()=>f});var e=o(1571),s=o(6895);function v(_,C){if(1&_&&(e.TgZ(0,"p",6),e._uU(1),e.qZA()),2&_){const Z=e.oxw();e.xp6(1),e.Oqu(Z.context)}}function p(_,C){1&_&&(e.TgZ(0,"p")(1,"strong"),e._uU(2,"This action cannot be undone."),e.qZA()())}let f=(()=>{class _{constructor(){this.modalHeader="Delete?",this.context="",this.confirmationPrompt="Are you sure you want to delete?",this.canUndo=!1,this.rejectButtonText="Cancel",this.confirmButtonIconClasses="fa fa-trash-alt",this.confirmButtonText="Delete",this.onConfirm=new e.vpe,this.onReject=new e.vpe}reject(){this.onReject.emit()}confirm(){this.onConfirm.emit()}static#t=this.\u0275fac=function(m){return new(m||_)};static#e=this.\u0275cmp=e.Xpm({type:_,selectors:[["app-shared-confirmation"]],inputs:{modalHeader:"modalHeader",context:"context",confirmationPrompt:"confirmationPrompt",canUndo:"canUndo",rejectButtonText:"rejectButtonText",confirmButtonIconClasses:"confirmButtonIconClasses",confirmButtonText:"confirmButtonText"},outputs:{onConfirm:"onConfirm",onReject:"onReject"},decls:20,vars:7,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body","text-center"],["class","my-3",4,"ngIf"],[1,"my-3"],[4,"ngIf"],[1,"modal-footer"],[1,"text-right"],[1,"btn","btn-danger",3,"click"],["aria-hidden","true",3,"ngClass"],[1,"btn","btn-primary","ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-times"]],template:function(m,u){1&m&&(e.TgZ(0,"div",0)(1,"h4",1)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"button",2),e.NdJ("click",function(){return u.reject()}),e.TgZ(5,"span",3),e._uU(6,"\xd7"),e.qZA()()(),e.TgZ(7,"div",4),e.YNc(8,v,2,1,"p",5),e.TgZ(9,"p",6),e._uU(10),e.qZA(),e.YNc(11,p,3,0,"p",7),e.qZA(),e.TgZ(12,"div",8)(13,"div",9)(14,"button",10),e.NdJ("click",function(){return u.confirm()}),e._UZ(15,"i",11),e._uU(16),e.qZA(),e.TgZ(17,"button",12),e.NdJ("click",function(){return u.reject()}),e._UZ(18,"i",13),e._uU(19),e.qZA()()()),2&m&&(e.xp6(3),e.Oqu(u.modalHeader),e.xp6(5),e.Q6J("ngIf",u.context),e.xp6(2),e.Oqu(u.confirmationPrompt),e.xp6(1),e.Q6J("ngIf",!u.canUndo),e.xp6(4),e.Q6J("ngClass",u.confirmButtonIconClasses),e.xp6(1),e.hij(" ",u.confirmButtonText," "),e.xp6(3),e.hij(" ",u.rejectButtonText," "))},dependencies:[s.mk,s.O5],encapsulation:2})}return _})()},1892:(x,g,o)=>{o.d(g,{C:()=>v});var e=o(6895),s=o(1571);let v=(()=>{class p{static#t=this.\u0275fac=function(C){return new(C||p)};static#e=this.\u0275mod=s.oAB({type:p});static#n=this.\u0275inj=s.cJS({imports:[e.ez]})}return p})()},9913:(x,g,o)=>{o.d(g,{Z:()=>w});var e=o(1571),s=o(433),v=o(8372),p=o(9766),f=o(6895),_=o(2210),C=o(805),Z=o(5722);function m(l,t){if(1&l&&(e.TgZ(0,"div",9)(1,"em"),e._uU(2),e.qZA()()),2&l){const r=e.oxw(2);e.xp6(2),e.Oqu(r.filter.metadata.visibleName)}}const u=function(){return[]};function A(l,t){if(1&l&&(e.TgZ(0,"p-dropdown",7),e.YNc(1,m,3,1,"ng-template",8),e.qZA()),2&l){const r=e.oxw();e.Q6J("formControl",r.control)("options",r.filter.metadata.options||e.DdM(5,u))("filter",!0)("placeholder",r.filter.metadata.visibleName)("showClear",r.filter.value&&!r.filter.metadata.required)}}function T(l,t){if(1&l&&e._UZ(0,"p-multiSelect",10),2&l){const r=e.oxw();e.Q6J("formControl",r.control)("options",r.filter.metadata.options||e.DdM(3,u))("placeholder",r.filter.metadata.visibleName)}}function b(l,t){if(1&l&&e._UZ(0,"p-multiSelect",11),2&l){const r=e.oxw();e.Q6J("formControl",r.control)("filter",!1)("options",r.filter.metadata.options||e.DdM(4,u))("placeholder",r.filter.metadata.visibleName)}}function y(l,t){if(1&l&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&l){const r=t.$implicit;e.Q6J("value",r.value),e.xp6(1),e.Oqu(r.name)}}function I(l,t){if(1&l&&(e.TgZ(0,"select",12),e.YNc(1,y,2,2,"option",13),e.qZA()),2&l){const r=e.oxw();e.Q6J("formControl",r.control),e.xp6(1),e.Q6J("ngForOf",r.filter.metadata.options)}}function O(l,t){if(1&l){const r=e.EpF();e.TgZ(0,"a",15),e.NdJ("click",function(){e.CHM(r);const E=e.oxw();return e.KtG(E.onRemove.emit())}),e._UZ(1,"i",16),e.qZA()}}let w=(()=>{class l{constructor(){this.canRemove=!0,this.filterClass="",this.onRemove=new e.vpe}get FilterType(){return p.v}ngOnInit(){this.control=new s.p4(this.filter.value),this.control.valueChanges.pipe((0,v.b)(200)).subscribe(r=>{this.filter.value=r}),this.filter.valueChanges.subscribe(()=>{this.control.setValue(this.filter.value,{emitEvent:!1})})}static#t=this.\u0275fac=function(R){return new(R||l)};static#e=this.\u0275cmp=e.Xpm({type:l,selectors:[["alasta-filter-item"]],inputs:{filter:"filter",canRemove:"canRemove",filterClass:"filterClass"},outputs:{onRemove:"onRemove"},decls:7,vars:6,consts:[["id","filter-item",3,"ngClass"],["id","filter-value",3,"ngSwitch"],["optionLabel","name","optionValue","value","styleClass","alasta-filter-dropdown",3,"formControl","options","filter","placeholder","showClear",4,"ngSwitchCase"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","options","placeholder",4,"ngSwitchCase"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","filter","options","placeholder",4,"ngSwitchCase"],[3,"formControl",4,"ngSwitchDefault"],["id","filter-remover","class","btn btn-sm btn-secondary-outline p-1",3,"click",4,"ngIf"],["optionLabel","name","optionValue","value","styleClass","alasta-filter-dropdown",3,"formControl","options","filter","placeholder","showClear"],["pTemplate","header"],[1,"filter-dropdown-header"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","options","placeholder"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","filter","options","placeholder"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["id","filter-remover",1,"btn","btn-sm","btn-secondary-outline","p-1",3,"click"],[1,"fas","fa-trash-alt"]],template:function(R,E){1&R&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,A,2,6,"p-dropdown",2),e.YNc(3,T,1,4,"p-multiSelect",3),e.YNc(4,b,1,5,"p-multiSelect",4),e.YNc(5,I,2,2,"select",5),e.qZA(),e.YNc(6,O,2,0,"a",6),e.qZA()),2&R&&(e.Q6J("ngClass",E.filterClass),e.xp6(1),e.Q6J("ngSwitch",E.filter.metadata.type),e.xp6(1),e.Q6J("ngSwitchCase",E.FilterType.DROPDOWN_SEARCH),e.xp6(1),e.Q6J("ngSwitchCase",E.FilterType.MULTISELECT_SEARCH),e.xp6(1),e.Q6J("ngSwitchCase",E.FilterType.MULTISELECT),e.xp6(2),e.Q6J("ngIf",E.canRemove))},dependencies:[f.mk,f.sg,f.O5,f.RF,f.n9,f.ED,s.YN,s.Kr,s.EJ,s.JJ,s.oH,_.Lt,C.jx,Z.NU],styles:["#filter-item[_ngcontent-%COMP%]{border-radius:.25rem;display:inline-flex;justify-content:center;align-items:center}#filter-item[_ngcontent-%COMP%]   #filter-remover[_ngcontent-%COMP%]{margin:0 .3rem;width:1.4rem;height:1.4rem;line-height:0;border-radius:.25%}.filter-dropdown-header[_ngcontent-%COMP%]{padding:.2rem .75rem;background-color:#efefef}"]})}return l})()},7064:(x,g,o)=>{o.d(g,{i:()=>Z});var e=o(6895),s=o(433),v=o(9245),p=o(3345),f=o(2210),_=o(5722),C=o(1571);let Z=(()=>{class m{static#t=this.\u0275fac=function(T){return new(T||m)};static#e=this.\u0275mod=C.oAB({type:m});static#n=this.\u0275inj=C.cJS({imports:[e.ez,s.UX,v.mr,p.k,f.kW,_.q4]})}return m})()},9766:(x,g,o)=>{o.d(g,{v:()=>e});var e=(()=>{return(s=e||(e={}))[s.DROPDOWN_SEARCH=0]="DROPDOWN_SEARCH",s[s.MULTISELECT_SEARCH=1]="MULTISELECT_SEARCH",s[s.MULTISELECT=2]="MULTISELECT",s[s.TEXT_INPUT=3]="TEXT_INPUT",s[s.TOGGLE=4]="TOGGLE",e;var s})()},6817:(x,g,o)=>{o.d(g,{w:()=>s});var e=o(1571);class s{constructor(p,f){this.valueChanges=new e.vpe,this.metadata=p,this.value=f}set value(p){this.setValue(p)}setValue(p,f=!0,_){this._value=p,f&&this.valueChanges.emit({value:this._value,additional:_})}get value(){return this._value}}},8283:(x,g,o)=>{o.d(g,{B:()=>_});var e=o(3905),s=o(4004),v=o(2340),p=o(1571),f=o(529);let _=(()=>{class C{constructor(m){this.http=m,this.serverUrl=v.N.v2apiServer}listAccounts(m,u,A,T){return(0,e.z)(this.http.post(this.serverUrl+"account/list",T,{params:{...m?{search:m}:{},...A?{page:A}:{},...u?{count:u}:{}}}).pipe(b=>b))}sendRegistrationReminder(m){return(0,e.z)(this.http.post(this.serverUrl+"account/remind-registration/"+m,{}).pipe((0,s.U)(u=>({account:u}))))}editAccount(m,u,A){return(0,e.z)(this.http.put(this.serverUrl+"account/"+m,{...u?{email:u}:{},...A?{role:A}:{}}).pipe((0,s.U)(T=>({account:T}))))}getAccount(m){return(0,e.z)(this.http.get(this.serverUrl+"account/"+m).pipe((0,s.U)(u=>({account:u}))))}static#t=this.\u0275fac=function(u){return new(u||C)(p.LFG(f.eN))};static#e=this.\u0275prov=p.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},2135:(x,g,o)=>{o.r(g),o.d(g,{AccountsModule:()=>lt});var e=o(6895),s=o(433),v=o(2714),p=o(5593),f=o(1740),_=o(420),C=o(1892),Z=o(7064),m=o(2342),u=o(3345),A=o(5973),T=o(3113),b=o(5861),y=o(727),I=o(8372),O=o(6817),w=o(9766),l=o(625),t=o(1571),r=o(8283),R=o(9649),E=o(171),S=o(2733),P=o(805),D=o(9913),L=o(2962),N=o(76),J=o(1507);const k=function(i){return["/","app","talent","view",i]};function B(i,h){if(1&i&&(t.TgZ(0,"div",17)(1,"div",18)(2,"p"),t._uU(3," This account is associated with the following talent "),t.qZA()(),t.TgZ(4,"div",19)(5,"a",20),t._UZ(6,"i",21),t._uU(7,"View Talent "),t.qZA()(),t.TgZ(8,"div",22)(9,"h6"),t._uU(10,"Talent name"),t.qZA(),t.TgZ(11,"p"),t._uU(12),t.qZA()(),t.TgZ(13,"div",22)(14,"h6"),t._uU(15,"Keiro Profile ID"),t.qZA(),t.TgZ(16,"p"),t._uU(17),t.qZA()()()),2&i){const n=t.oxw();t.xp6(5),t.Q6J("routerLink",t.VKq(4,k,n.talent._id)),t.xp6(7),t.AsE("",n.talent.name.given," ",n.talent.name.last,""),t.xp6(5),t.Oqu(n.talent._id)}}function K(i,h){1&i&&(t.TgZ(0,"h6",23),t._uU(1,"There is no associated Talent for this account. Please contact Alasta Support."),t.qZA())}function W(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.editMode=!0)}),t._UZ(1,"i",25),t._uU(2,"Edit "),t.qZA()}}function F(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(a){t.CHM(n);const d=t.oxw(2);return d.onClickRemind.emit(a),t.KtG(d.clickedRemind=!0)}),t._UZ(1,"i",30),t._uU(2,"Remind "),t.qZA()}if(2&i){const n=t.oxw(2);t.Q6J("disabled",n.clickedRemind)}}function Q(i,h){if(1&i&&(t.TgZ(0,"div",26)(1,"div",27)(2,"h6"),t._uU(3,"Login email address"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.YNc(6,F,3,1,"button",28),t.qZA()(),t.TgZ(7,"div",27)(8,"h6"),t._uU(9,"Keiro access level"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"roleName"),t.qZA()()()),2&i){const n=t.oxw();t.xp6(5),t.hij(" ",null==n.account?null:n.account.email," "),t.xp6(1),t.Q6J("ngIf",!(null!=n.account&&n.account.pwd)),t.xp6(5),t.Oqu(t.lcZ(12,3,null==n.account?null:n.account.role))}}function Y(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"keiro-account-form",31),t.NdJ("statusChanges",function(a){t.CHM(n);const d=t.oxw();return t.KtG(d.formStatusChange(a))})("valueChanges",function(a){t.CHM(n);const d=t.oxw();return t.KtG(d.formValueChange(a))}),t.qZA()}if(2&i){const n=t.oxw();t.Q6J("initialValue",n.account)("canCreateRoles",n.canCreateRoles)}}function H(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"div",32)(1,"button",33),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.editMode=!1)}),t._UZ(2,"i",34),t._uU(3,"Cancel "),t.qZA(),t.TgZ(4,"button",35),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.onSumbitChange.emit(a.formValue))}),t._UZ(5,"i",36),t._uU(6,"Save "),t.qZA()()}if(2&i){const n=t.oxw();t.xp6(4),t.Q6J("disabled",!n.onlyRoleChange&&!n.formValid||n.processing)}}function j(i,h){1&i&&t._UZ(0,"hr",7),2&i&&t.Udp("width",80,"%")}function G(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"div"),t.YNc(1,j,1,2,"hr",37),t.TgZ(2,"button",38),t.NdJ("click",function(a){t.CHM(n);const d=t.oxw();return t.KtG(d.onClickRevoke.emit(a))}),t._UZ(3,"i",39),t._uU(4,"Revoke account "),t.qZA()()}if(2&i){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.talent)}}let q=(()=>{class i{constructor(){this.editMode=!1,this.canModifyAccount=!1,this.processing=!1,this.onClickRemind=new t.vpe,this.onClickRevoke=new t.vpe,this.onSumbitChange=new t.vpe,this.onCloseModal=new t.vpe,this.formValid=!1,this.onlyRoleChange=!1,this.clickedRemind=!1}set account(n){this.editMode=!1,this._account=n}get account(){return this._account}formStatusChange(n){this.formValid="VALID"===n}formValueChange(n){this.onlyRoleChange=this.account?.email===n.email&&this.account.role!=n.role,this.formValue=n}static#t=this.\u0275fac=function(c){return new(c||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["org-accounts-manage-account-modal"]],inputs:{account:"account",talent:"talent",canCreateRoles:"canCreateRoles",canModifyAccount:"canModifyAccount",processing:"processing"},outputs:{onClickRemind:"onClickRemind",onClickRevoke:"onClickRevoke",onSumbitChange:"onSumbitChange",onCloseModal:"onCloseModal"},decls:26,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["class","form-row",4,"ngIf","ngIfElse"],["noAssociatedTalent",""],[1,"my-3"],["class","btn btn-sm btn-secondary",3,"click",4,"ngIf"],["class","row",4,"ngIf","ngIfElse"],["accountEditMode",""],["class","mb-2",4,"ngIf"],[4,"ngIf"],[1,"modal-footer"],[1,"text-right"],[1,"btn","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-times"],[1,"form-row"],[1,"col"],[1,"col-auto"],[1,"btn","btn-sm","btn-secondary",3,"routerLink"],["aria-hidden","true",1,"fa","fa-external-link-alt","mr-1"],[1,"col-12"],[1,"alert","alert-warning"],[1,"btn","btn-sm","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-pencil-alt","mr-1"],[1,"row"],[1,"col-12","col-md-6"],["class","btn btn-sm btn-secondary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-paper-plane","mr-1"],[3,"initialValue","canCreateRoles","statusChanges","valueChanges"],[1,"mb-2"],[1,"btn","btn-primary","mr-1",3,"click"],["aria-hidden","true",1,"fa","fa-times","mr-1"],[1,"btn","btn-secondary",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-check","mr-1"],["class","my-3",3,"width",4,"ngIf"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["aria-hidden","true",1,"fa","fa-door-closed","mr-1"]],template:function(c,a){if(1&c&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2," Manage Keiro Account "),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(M){return a.onCloseModal.emit(M)}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4)(7,"h5"),t._uU(8,"Associated Talent"),t.qZA(),t.YNc(9,B,18,6,"div",5),t.YNc(10,K,2,0,"ng-template",null,6,t.W1O),t._UZ(12,"hr",7),t.TgZ(13,"h5"),t._uU(14," Account information "),t.YNc(15,W,3,0,"button",8),t.qZA(),t.YNc(16,Q,13,5,"div",9),t.YNc(17,Y,1,2,"ng-template",null,10,t.W1O),t.YNc(19,H,7,1,"div",11),t.YNc(20,G,5,1,"div",12),t.qZA(),t.TgZ(21,"div",13)(22,"div",14)(23,"button",15),t.NdJ("click",function(M){return a.onCloseModal.emit(M)}),t._UZ(24,"i",16),t._uU(25," Close "),t.qZA()()()),2&c){const d=t.MAs(11),M=t.MAs(18);t.xp6(9),t.Q6J("ngIf",a.talent)("ngIfElse",d),t.xp6(3),t.Udp("width",80,"%"),t.xp6(3),t.Q6J("ngIf",a.canModifyAccount&&!a.editMode),t.xp6(1),t.Q6J("ngIf",0==a.editMode)("ngIfElse",M),t.xp6(3),t.Q6J("ngIf",a.editMode),t.xp6(1),t.Q6J("ngIf",a.canModifyAccount&&a.talent)}},dependencies:[e.O5,v.rH,J.g,T.p]})}return i})();const V=["searchInput"];function z(i,h){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Email"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Role"),t.qZA(),t.TgZ(5,"th"),t._uU(6," Completed account? "),t._UZ(7,"app-shared-icon-tooltip",16),t.qZA(),t._UZ(8,"th"),t.qZA())}function X(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2).$implicit,d=t.oxw();return t.KtG(d.sendAccountRegisterEmail(a._id))}),t.qZA()}if(2&i){const n=t.oxw(2).$implicit,c=t.oxw();t.Q6J("loading",c.sendingReminder)("disabled",c.wasRecentlyReminded(n._id))}}function $(i,h){1&i&&(t.TgZ(0,"span",22),t._UZ(1,"i",23),t.TgZ(2,"em"),t._uU(3,"Email sent"),t.qZA()())}function tt(i,h){if(1&i&&(t.TgZ(0,"span"),t.YNc(1,X,1,2,"button",19),t.YNc(2,$,4,0,"ng-template",null,20,t.W1O),t.qZA()),2&i){const n=t.MAs(3),c=t.oxw().$implicit,a=t.oxw();t.xp6(1),t.Q6J("ngIf",!a.wasRecentlyReminded(c._id))("ngIfElse",n)}}function et(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"td")(1,"button",24),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().$implicit,d=t.oxw(),M=t.MAs(23);return t.KtG(d.openAccountManagementModal(M,a))}),t.qZA()()}if(2&i){const n=t.oxw(2);t.xp6(1),t.Q6J("loading",n.loadingTalentInfo)}}function nt(i,h){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"roleName"),t.qZA(),t.TgZ(6,"td")(7,"span",17),t._uU(8),t.qZA(),t.YNc(9,tt,4,2,"span",18),t.qZA(),t.YNc(10,et,2,1,"td",18),t.qZA()),2&i){const n=h.$implicit,c=t.oxw();t.xp6(2),t.Oqu(n.email),t.xp6(2),t.Oqu(t.lcZ(5,5,n.role)),t.xp6(4),t.hij(" ",n.pwd?"Yes":"No"," "),t.xp6(1),t.Q6J("ngIf",!n.pwd),t.xp6(1),t.Q6J("ngIf",c.canEditExistingPositions)}}function ot(i,h){if(1&i&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&i){const n=t.oxw();t.xp6(1),t.hij("",n.total," total")}}function at(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"app-shared-confirmation",25),t.NdJ("onConfirm",function(){t.CHM(n);const a=t.oxw();return a.revokeAccount(a.targetTalent._id,a.targetAccount.email),t.KtG(a.modalsController.closeUpperModal())})("onReject",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.modalsController.closeUpperModal())}),t.qZA()}2&i&&t.Q6J("canUndo",!0)}function it(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"org-accounts-manage-account-modal",26),t.NdJ("onClickRevoke",function(){t.CHM(n);const a=t.oxw(),d=t.MAs(21);return t.KtG(a.modalsController.openModal(d))})("onClickRemind",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.sendAccountRegisterEmail(a.targetAccount._id))})("onSumbitChange",function(a){t.CHM(n);const d=t.oxw();return t.KtG(d.handleAddEditSubmission(a))})("onCloseModal",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.modalsController.closeUpperModal())}),t.qZA()}if(2&i){const n=t.oxw();t.Q6J("talent",n.targetTalent)("account",n.targetAccount)("canCreateRoles",n.canCreateRoles)("canModifyAccount",n.currentAccountId!=(null==n.targetAccount?null:n.targetAccount._id))("processing",n.processingModalRequest)}}const ct=function(){return[10,25,50]};let st=(()=>{class i{constructor(n,c,a,d,M,rt){this.accountsServiceApi=n,this.talentsManagementServiceApi=c,this.authStateService=a,this.roleNamePipe=d,this.modalsController=M,this.messageService=rt,this.canEditExistingPositions=!0,this.searchInputControl=new s.p4,this.subscriptions=new y.w0,this.total=0,this.page=0,this.step=10,this.rows=[],this.loadingIndicator=!1,this.sendingReminder=!1,this.recentlyReminded=[],this.wasRecentlyReminded=U=>this.recentlyReminded.some(ut=>ut._id==U),this.canCreateRoles=[l.u.ADMIN,l.u.MANAGER,l.u.EMPLOYEE],this.processingModalRequest=!1,this.loadingTalentInfo=!1,this.roleFilter=new O.w({id:"roleFilter",type:w.v.MULTISELECT,visibleName:"Select Roles",key:"roles",groupOrder:1,options:this.getRoleOptions()},this.getRoleOptions().map(U=>U.value)),this.subscriptions.add(this.searchInputControl.valueChanges.pipe((0,I.b)(350)).subscribe(U=>{this.searchInputControl.valid&&this.fetchAccountsWithPagination()})),this.subscriptions.add(this.roleFilter.valueChanges.pipe((0,I.b)(350)).subscribe(U=>{this.fetchAccountsWithPagination()})),this.subscriptions.add(this.authStateService.authState.subscribe(U=>{this.currentAccountId=U.identity?.accountId}))}ngAfterViewInit(){this.input?.nativeElement.focus()}ngOnDestroy(){this.modalsController.closeUpperModal(),this.subscriptions.unsubscribe()}getRoleOptions(){return Object.values(l.u).filter(n=>n!=l.u.SUPER_ADMIN).map(n=>({name:this.roleNamePipe.transform(n),value:n}))}showSuccessMessage(n,c){this.messageService.add({severity:"success",summary:n,detail:c,life:3e3})}showErrorMessage(n,c){this.messageService.add({severity:"error",summary:n,detail:c,life:4e3})}setPage(n){this.step=n.rows,this.page=Math.floor(n.first/n.rows),this.fetchAccountsWithPagination()}openAccountManagementModal(n,c){var a=this;return(0,b.Z)(function*(){a.targetAccount=c,a.loadingTalentInfo=!0,a.targetTalent=yield a.fetchTalentInfoForAccount(c._id),a.loadingTalentInfo=!1,a.modalsController.openModal(n,{class:"modal-lg"})})()}fetchAccountsWithPagination(){this.loadingIndicator=!0,this.accountsServiceApi.listAccounts(this.searchInputControl.value,this.step,this.page,{roles:this.roleFilter.value}).then(n=>{this.rows=n.paginatedList,this.total=n.totalElements}).catch(()=>{this.showErrorMessage("Error","Your request could not be processed")}).finally(()=>{this.loadingIndicator=!1})}sendAccountRegisterEmail(n){this.sendingReminder=!0,this.accountsServiceApi.sendRegistrationReminder(n).then(c=>{this.recentlyReminded.push(c.account)}).catch(()=>{this.showErrorMessage("Error","There was an error sending the email")}).finally(()=>{this.sendingReminder=!1})}fetchTalentInfoForAccount(n){var c=this;return(0,b.Z)(function*(){return c.talentsManagementServiceApi.getTalentByAccount(n).then(a=>a.talent).catch(()=>{c.showErrorMessage("Error","There was an error loading the Talent information")})})()}handleAddEditSubmission(n){null!=this.targetAccount?(this.processingModalRequest=!0,this.accountsServiceApi.editAccount(this.targetAccount?._id,n.email!==this.targetAccount.email?n.email:void 0,n.role!==this.targetAccount.role?n.role:void 0).then(c=>this.handleSuccessEdit(c.account)).catch(()=>{this.showErrorMessage("Error","There was an error while editing this Account")}).finally(()=>{this.processingModalRequest=!1})):console.warn("No target account")}handleSuccessEdit(n){this.targetAccount=n,this.showSuccessMessage("Edited","Successfully edited the account"),this.fetchAccountsWithPagination()}revokeAccount(n,c){this.talentsManagementServiceApi.revokeTalentsAccount(n).then(a=>{this.targetTalent=void 0,this.modalsController.closeUpperModal(),this.fetchAccountsWithPagination(),this.showSuccessMessage("Revoked","Successfully revoked the account for "+c)}).catch(()=>{this.showErrorMessage("Error","There was an error while editing this Account")})}static#t=this.\u0275fac=function(c){return new(c||i)(t.Y36(r.B),t.Y36(R.C),t.Y36(E.V),t.Y36(T.p),t.Y36(S.l),t.Y36(P.ez))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["alasta-accounts"]],viewQuery:function(c,a){if(1&c&&t.Gf(V,5),2&c){let d;t.iGM(d=t.CRH())&&(a.input=d.first)}},decls:24,vars:11,consts:[[1,"card","content-section-card"],[1,"card-body"],[1,"form-row"],[1,"mb-1","col","order-2","order-md-1"],["filterClass","border border-primary",3,"filter","canRemove"],[1,"p-fluid","mb-1","col-12","col-md-6","col-lg-5","order-1","order-md-2"],[1,"p-input-icon-left"],[1,"fa","fa-search"],["type","text","pInputText","","placeholder","Search by email address",3,"formControl"],["searchInput",""],["styleClass","p-datatable-sm","responsiveLayout","scroll",3,"value","lazy","loading","paginator","rows","totalRecords","rowsPerPageOptions","onLazyLoad"],["pTemplate","header"],["pTemplate","body"],["pTemplate","paginatorleft"],["revokeAccountModal",""],["manageAccountModal",""],["accentLevel","light","iconClasses","fa fa-info-circle","placement","bottom","tooltipMessage","If this user has set a password to complete their account yet."],[1,"align-middle"],[4,"ngIf"],["pButton","","class","p-button-sm p-button-rounded p-button-outlined d-inline align-middle","icon","fas fa-paper-plane","label","Remind",3,"loading","disabled","click",4,"ngIf","ngIfElse"],["sentEmail",""],["pButton","","icon","fas fa-paper-plane","label","Remind",1,"p-button-sm","p-button-rounded","p-button-outlined","d-inline","align-middle",3,"loading","disabled","click"],[1,"text-success"],["aria-hidden","true",1,"fa","fa-check","mx-1"],["pButton","","icon","fas fa-user-cog","label","Options",1,"p-button-secondary","p-button-rounded",3,"loading","click"],["modalHeader","Revoke this account?","confirmButtonText","Revoke account","confirmButtonIconClasses","fa fa-door-closed","context","This account will be revoked, but the talent's profile will remain. Another account can be created for this talent at any time in the future.","confirmationPrompt","",3,"canUndo","onConfirm","onReject"],[3,"talent","account","canCreateRoles","canModifyAccount","processing","onClickRevoke","onClickRemind","onSumbitChange","onCloseModal"]],template:function(c,a){1&c&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h4"),t._uU(3,"Accounts"),t.qZA(),t.TgZ(4,"p"),t._uU(5," This is the list of all accounts that can access the Keiro Talent Management system."),t._UZ(6,"br"),t._uU(7," Here you can manage these accounts such as revoke access and change roles. "),t.qZA(),t.TgZ(8,"div",2)(9,"div",3),t._UZ(10,"alasta-filter-item",4),t.qZA(),t.TgZ(11,"div",5)(12,"span",6),t._UZ(13,"i",7)(14,"input",8,9),t.qZA()()(),t.TgZ(16,"p-table",10),t.NdJ("onLazyLoad",function(M){return a.setPage(M)}),t.YNc(17,z,9,0,"ng-template",11),t.YNc(18,nt,11,7,"ng-template",12),t.YNc(19,ot,2,1,"ng-template",13),t.qZA()()(),t.YNc(20,at,1,1,"ng-template",null,14,t.W1O),t.YNc(22,it,1,5,"ng-template",null,15,t.W1O)),2&c&&(t.xp6(10),t.Q6J("filter",a.roleFilter)("canRemove",!1),t.xp6(4),t.Q6J("formControl",a.searchInputControl),t.xp6(2),t.Q6J("value",a.rows)("lazy",!0)("loading",a.loadingIndicator)("paginator",!0)("rows",a.step)("totalRecords",a.total)("rowsPerPageOptions",t.DdM(10,ct)))},dependencies:[e.O5,s.Fj,s.JJ,s.oH,_.iA,P.jx,f.o,p.Hq,D.Z,L.s,N.S,q,T.p]})}return i})(),lt=(()=>{class i{static#t=this.\u0275fac=function(c){return new(c||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({providers:[T.p],imports:[e.ez,v.Bz.forChild([{path:"",component:st}]),s.UX,_.U$,f.j,p.hJ,Z.i,A.s,u.k,m.M,C.C]})}return i})()}}]);