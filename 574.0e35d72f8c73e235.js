"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[574],{527:(Z,D,a)=>{a.d(D,{d:()=>d});class d{static conditionalValidator(f,h){return E=>E.parent&&f()&&null!==h?h(E):null}static isNotValue(f){return h=>void 0===f||h.value!==f?null:{valueInArray:{value:h.value}}}static valueNotInArray(f){return h=>f.includes(h.value)?{valueInArray:{value:h.value}}:null}static valueInArray(f){return h=>f.includes(h.value)?null:{valueNotInOptions:{value:h.value}}}static lessThanValidator(f){return h=>{if(this.isEmptyInputValue(h.value)||this.isEmptyInputValue(f))return null;const E=parseFloat(h.value);return!isNaN(E)&&E>=f?{lessThan:{lessThan:f,actual:h.value}}:null}}static greaterThanValidator(f){return h=>{if(this.isEmptyInputValue(h.value)||this.isEmptyInputValue(f))return null;const E=parseFloat(h.value);return!isNaN(E)&&E<=f?{greaterThan:{greaterThan:f,actual:h.value}}:null}}static isNumeric(){return f=>this.isEmptyInputValue(f.value)||!isNaN(parseFloat(f.value))&&isFinite(f.value)?null:{notNumeric:{value:f.value}}}static isEmptyInputValue(f){return null==f||("string"==typeof f||Array.isArray(f))&&0===f.length}}},9147:(Z,D,a)=>{a.d(D,{Ib:()=>O,Vg:()=>p,ub:()=>_});var y,d=a(3905),l=a(4004),f=a(2340),h=a(1571),E=a(529),p=(()=>{return(o=p||(p={}))[o.CANDIDATE=0]="CANDIDATE",o[o.CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED=1]="CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED",o[o.CANDIDATE_ENDED_NOT_DESIRED=2]="CANDIDATE_ENDED_NOT_DESIRED",o[o.ACTIVE=10]="ACTIVE",o[o.ENDED=19]="ENDED",o[o.CHANGE_PROMOTION=20]="CHANGE_PROMOTION",o[o.CHANGE_LATERAL_MOVEMENT=21]="CHANGE_LATERAL_MOVEMENT",o[o.CHANGE_TRANSFER_SAME_POSITION=22]="CHANGE_TRANSFER_SAME_POSITION",o[o.CHANGE_TRANSFER_PROMOTION=23]="CHANGE_TRANSFER_PROMOTION",o[o.DISMISSAL_VOLUNTARY_ABSENTEEISM=50]="DISMISSAL_VOLUNTARY_ABSENTEEISM",o[o.DISMISSAL_VOLUNTARY_ABANDONMENT=51]="DISMISSAL_VOLUNTARY_ABANDONMENT",o[o.DISMISSAL_VOLUNTARY_RETIREMENT=52]="DISMISSAL_VOLUNTARY_RETIREMENT",o[o.DISMISSAL_VOLUNTARY_BETTER_OFFER=53]="DISMISSAL_VOLUNTARY_BETTER_OFFER",o[o.DISMISSAL_VOLUNTARY_PERSONAL=54]="DISMISSAL_VOLUNTARY_PERSONAL",o[o.DISMISSAL_FORCED_END_OF_CONTRACT=70]="DISMISSAL_FORCED_END_OF_CONTRACT",o[o.DISMISSAL_FORCED_DISEASE=71]="DISMISSAL_FORCED_DISEASE",o[o.DISMISSAL_FORCED_DEATH=72]="DISMISSAL_FORCED_DEATH",o[o.DISMISSAL_FORCED_LOW_PERFORMANCE=73]="DISMISSAL_FORCED_LOW_PERFORMANCE",o[o.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS=74]="DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS",o[o.DISMISSAL_FORCED_OTHERS=75]="DISMISSAL_FORCED_OTHERS",p;var o})();class _{}y=_,_.changesReasons=[p.CHANGE_PROMOTION,p.CHANGE_LATERAL_MOVEMENT,p.CHANGE_TRANSFER_SAME_POSITION,p.CHANGE_TRANSFER_PROMOTION],_.voluntaryDismissalReasons=[p.DISMISSAL_VOLUNTARY_ABSENTEEISM,p.DISMISSAL_VOLUNTARY_ABANDONMENT,p.DISMISSAL_VOLUNTARY_RETIREMENT,p.DISMISSAL_VOLUNTARY_BETTER_OFFER,p.DISMISSAL_VOLUNTARY_PERSONAL],_.forcedDismissalReasons=[p.DISMISSAL_FORCED_END_OF_CONTRACT,p.DISMISSAL_FORCED_DISEASE,p.DISMISSAL_FORCED_DEATH,p.DISMISSAL_FORCED_LOW_PERFORMANCE,p.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS,p.DISMISSAL_FORCED_OTHERS],_.allDismissalReasons=[...y.voluntaryDismissalReasons,...y.forcedDismissalReasons],_.statusNameMap=new Map([[p.CANDIDATE,"Candidate"],[p.CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED,"Candidate ended but not selected"],[p.CANDIDATE_ENDED_NOT_DESIRED,"Candidate not desired"],[p.ACTIVE,"Active"],[p.ENDED,"Ended"],[p.CHANGE_PROMOTION,"Promotion"],[p.CHANGE_LATERAL_MOVEMENT,"Lateral movement"],[p.CHANGE_TRANSFER_SAME_POSITION,"Transfer same position"],[p.CHANGE_TRANSFER_PROMOTION,"Transfer promotion"],[p.DISMISSAL_VOLUNTARY_ABSENTEEISM,"Absenteeism"],[p.DISMISSAL_VOLUNTARY_ABANDONMENT,"Abandonment"],[p.DISMISSAL_VOLUNTARY_RETIREMENT,"Retirement"],[p.DISMISSAL_VOLUNTARY_BETTER_OFFER,"Better offer"],[p.DISMISSAL_VOLUNTARY_PERSONAL,"Personal"],[p.DISMISSAL_FORCED_END_OF_CONTRACT,"End of contract"],[p.DISMISSAL_FORCED_DISEASE,"Disease"],[p.DISMISSAL_FORCED_DEATH,"Death"],[p.DISMISSAL_FORCED_LOW_PERFORMANCE,"Low performance"],[p.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS,"Inapropiate behaviors"],[p.DISMISSAL_FORCED_OTHERS,"Other"]]);let O=(()=>{class o{constructor(u){this.http=u,this.serverUrl=f.N.v2apiServer}static formatDates(u){return{...u,...u.from?{from:new Date(u.from)}:{},...u.until?{until:new Date(u.until)}:{}}}createEmploymentRecord(u,v,C,A,w){return(0,d.z)(this.http.post(this.serverUrl+"employment/",{job:u,talent:v,status:C,from:A.toISOString(),...w?{allowMultiple:w}:{}}).pipe((0,l.U)(S=>o.formatDates(S))))}getActiveEmploymentForTalent(u){return(0,d.z)(this.http.get(this.serverUrl+"employment/active/"+u).pipe((0,l.U)(v=>v?o.formatDates(v):null)))}getRelevantEmploymentForReview(u,v){return(0,d.z)(this.http.get(this.serverUrl+"employment/relevant/"+u+"/"+v).pipe((0,l.U)(C=>C?o.formatDates(C):null)))}getEmploymentsForTalent(u){return(0,d.z)(this.http.get(this.serverUrl+"employment/talent/"+u).pipe((0,l.U)(v=>v.map(C=>o.formatDates(C)))))}editEmployment(u,v,C,A,w){return(0,d.z)(this.http.put(this.serverUrl+"employment/"+u,{from:v.toISOString(),...void 0!==C?{status:C}:{},...void 0!==A?{until:A}:{},...void 0!==w?{notes:w}:{}}).pipe((0,l.U)(S=>o.formatDates(S))))}endEmployment(u,v,C,A){return(0,d.z)(this.http.put(this.serverUrl+"employment/"+u,{status:v,until:C.toISOString(),...A?{notes:A}:{}}).pipe((0,l.U)(w=>o.formatDates(w))))}}return o.\u0275fac=function(u){return new(u||o)(h.LFG(E.eN))},o.\u0275prov=h.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},9649:(Z,D,a)=>{a.d(D,{C:()=>p});var d=a(3905),l=a(4004),f=a(2340),h=a(2027),E=a(1571),y=a(529);let p=(()=>{class _{constructor(o){this.http=o,this.serverUrl=f.N.apiServer,this.v2serverUrl=f.N.v2apiServer}convertDob(o){return{...o,...o.dob?{dateOfBirth:new h.p({values:{year:o.dob?.year,month:o.dob?.month,day:o.dob?.day}})}:{}}}convertToDto(o,c){const u=new Date(o.dobDate);return{givenName:o.firstNames,lastName:o.lastNames,languages:o.languages,nationality:o.nationality,mobility:o.mobility,dobDay:u.getDate(),dobMonth:u.getMonth()+1,dobYear:u.getFullYear(),...c?.email?{email:c?.email}:{},...c?.role?{role:c?.role}:{}}}findTalentsFilterSearch(o,c,u,v,C,A,w,S,U,x){const e={params:{count:o,page:c}};let V={...S?{area:S}:{},...U?{department:U}:{},...x?{name:x}:{}},N={...A?{country:A}:{},...w?{name:w}:{}},Y={...v?{cycleId:v}:{},...C?{mapPlacement:C}:{}};const P={...u?{searchTerm:u}:{},...Object.keys(V).length?{positionFilter:V}:{},...Object.keys(N).length?{propertyFilter:N}:{},...Object.keys(Y).length?{reviewFilter:Y}:{}};return(0,d.z)(this.http.post(this.v2serverUrl+"talent-finder",P,e).pipe(M=>M))}downloadTalentsFilterSearch(o,c,u,v,C,A,w,S){let U={...A?{area:A}:{},...w?{department:w}:{},...S?{name:S}:{}},x={...v?{country:v}:{},...C?{name:C}:{}},e={...c?{cycleId:c}:{},...u?{mapPlacement:u}:{}};const V={...o?{searchTerm:o}:{},...Object.keys(U).length?{positionFilter:U}:{},...Object.keys(x).length?{propertyFilter:x}:{},...Object.keys(e).length?{reviewFilter:e}:{}},N=document.createElement("form"),Y=this.v2serverUrl+"talent-finder/download";N.method="POST",N.action=Y,Object.entries(V).forEach(P=>{if(null==P[1])return;const M=document.createElement("input");M.type="hidden",M.name=P[0],M.setAttribute("value",JSON.stringify(P[1])),N.appendChild(M)}),document.body.appendChild(N),N.submit(),setTimeout(()=>document.body.removeChild(N),200)}checkEmailAvailability(o){return(0,d.z)(this.http.get(this.v2serverUrl+"talent/email/"+o).pipe(c=>c))}getTalent(o){return(0,d.z)(this.http.get(this.v2serverUrl+"talent/"+o).pipe((0,l.U)(c=>({talent:this.convertDob(c)}))))}createTalent(o,c){return(0,d.z)(this.http.post(this.v2serverUrl+"talent",this.convertToDto(o,c)).pipe((0,l.U)(u=>({talent:this.convertDob(u)}))))}createTalentAccount(o,c){return(0,d.z)(this.http.post(this.v2serverUrl+"talent/"+o+"/account",c).pipe((0,l.U)(u=>({talent:this.convertDob(u)}))))}createLegacyWorkInfo(o,c){return(0,d.z)(this.http.put(this.v2serverUrl+"talent/legacy-work/"+o,c).pipe((0,l.U)(u=>({talent:this.convertDob(u)}))))}getTalentByAccount(o){return(0,d.z)(this.http.get(this.v2serverUrl+"talent/account/"+o).pipe((0,l.U)(c=>({talent:this.convertDob(c)}))))}editTalent(o,c){return(0,d.z)(this.http.put(this.v2serverUrl+"talent/"+o,this.convertToDto(c)).pipe((0,l.U)(u=>({talent:this.convertDob(u)}))))}revokeTalentsAccount(o){return(0,d.z)(this.http.put(this.v2serverUrl+"talent/revoke-access/"+o,{}).pipe((0,l.U)(c=>({talent:this.convertDob(c)}))))}getSupportedCountries(){return(0,d.z)(this.http.get(this.v2serverUrl+"talent/countries/").pipe((0,l.U)(o=>({countries:o}))))}getSupportedLanguages(){return(0,d.z)(this.http.get(this.v2serverUrl+"talent/languages/").pipe((0,l.U)(o=>({languages:o}))))}}return _.\u0275fac=function(o){return new(o||_)(E.LFG(y.eN))},_.\u0275prov=E.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},9559:(Z,D,a)=>{a.d(D,{f:()=>_});var d=a(3905),l=a(4004),f=a(2340),h=a(2027),E=a(9550),y=a(1571),p=a(529);let _=(()=>{class O{constructor(c){this.http=c,this.serverV2Url=f.N.v2apiServer,this._getEvaluationFormDefinitionsCache=new E.F(this,this.getEvaluationFormDefinitions)}static formatDates(c){return{...c,...c.date?{date:new h.p({ISODateString:c.date})}:{}}}getTalentReviews(c){return(0,d.z)(this.http.get(this.serverV2Url+"review/talent/"+c).pipe((0,l.U)(u=>({talentReviews:u.map(v=>O.formatDates(v))}))))}editTalentReview(c,u){return(0,d.z)(this.http.put(this.serverV2Url+"review/"+c,u).pipe((0,l.U)(v=>v)))}addTalentReview(c){return(0,d.z)(this.http.post(this.serverV2Url+"review",c).pipe((0,l.U)(u=>u)))}obtainEvaluationDefinitionForTalents(c){return(0,d.z)(this.http.post(this.serverV2Url+"review/evaluation-definitions",{talentList:c}).pipe((0,l.U)(u=>u)))}getEvaluationFormDefinitions(){return(0,d.z)(this.http.get(this.serverV2Url+"review/form-definition").pipe((0,l.U)(c=>[...c])))}getCachedEvaluationFormDefinitions(){return this._getEvaluationFormDefinitionsCache.get()}getExampleForm(){return(0,d.z)(this.http.get(this.serverV2Url+"review/form-definition/exampleDefinition").pipe((0,l.U)(c=>c)))}evaluateWithForm(c){return(0,d.z)(this.http.post(this.serverV2Url+"review/form",c).pipe((0,l.U)(u=>u)))}}return O.\u0275fac=function(c){return new(c||O)(y.LFG(p.eN))},O.\u0275prov=y.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},4053:(Z,D,a)=>{a.d(D,{U:()=>p});var d=a(3905),l=a(4004),f=a(2340),h=a(9147),E=a(1571),y=a(529);let p=(()=>{class _{constructor(o){this.http=o,this.serverUrl=f.N.v2apiServer}getTeamByLeader(o){return(0,d.z)(this.http.get(this.serverUrl+"team/"+o).pipe((0,l.U)(c=>({...c,...c.employment?{employment:h.Ib.formatDates(c.employment)}:{},teamMembers:c.teamMembers.map(u=>({...u,...u.employment?{employment:h.Ib.formatDates(u.employment)}:{}}))}))))}getRelevantJobByTalent(o){return(0,d.z)(this.http.get(this.serverUrl+"team/relevant-job/"+o).pipe((0,l.U)(c=>c)))}getTopMostJobInHierarchy(){return(0,d.z)(this.http.get(this.serverUrl+"team/top-most-job/").pipe((0,l.U)(o=>o)))}addEndedEmployment(o,c,u,v,C,A,w){return(0,d.z)(this.http.post(this.serverUrl+"team/ended-employment",{title:void 0,leaderJob:void 0,property:o,position:c,talent:u,status:v,from:C,until:A,...w?{notes:w}:{}}).pipe((0,l.U)(S=>S)))}addJob(o,c,u){return(0,d.z)(this.http.post(this.serverUrl+"job/",{leader:o,property:c,position:u}).pipe((0,l.U)(v=>v)))}removeJob(o){return(0,d.z)(this.http.delete(this.serverUrl+"job/"+o).pipe((0,l.U)(c=>c)))}getOwnActiveResponsibiliy(){return(0,d.z)(this.http.get(this.serverUrl+"team/active-responsibility/").pipe((0,l.U)(o=>o)))}}return _.\u0275fac=function(o){return new(o||_)(E.LFG(y.eN))},_.\u0275prov=E.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},1658:(Z,D,a)=>{a.d(D,{d:()=>d});class d{static isInteger(){return f=>{const h=parseFloat(f.value);return!isNaN(h)&&isFinite(h)&&Number.isInteger(h)&&"number"==typeof h?null:{notInteger:{value:f.value}}}}}},1574:(Z,D,a)=>{a.r(D),a.d(D,{TalentFinderModule:()=>Xe});var d=a(6895),l=a(433),f=a(4789),h=a(5593),E=a(793),y=a(2320),p=a(7064),_=a(5861),O=a(727),o=a(7579),c=a(3905),u=a(4004),v=a(8372),C=a(5653),A=a(9766),w=a(2338),S=a(625),U=a(826),x=a(2027),e=a(1571),V=a(2733),N=a(171),Y=a(1831),P=a(1505),M=a(9559),X=a(4053),$=a(9649),ee=a(797),te=a(917),ie=a(4954),z=a(8254),H=a(805),ne=a(4829),Q=a(3608),q=a(1658),G=a(8816),J=a(1740),k=a(2210);function oe(n,r){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"form",3)(3,"div",4)(4,"div",5)(5,"label",6),e._uU(6,"Performance Score"),e.qZA(),e.TgZ(7,"div",7),e._UZ(8,"input",8),e.qZA(),e.TgZ(9,"small",9),e._uU(10),e.qZA()(),e.TgZ(11,"div",10)(12,"label",11),e._uU(13,"Potential Score"),e.qZA(),e.TgZ(14,"div",7),e._UZ(15,"p-dropdown",12),e.qZA(),e.TgZ(16,"small",13),e._uU(17),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.talentToReview.formGroup),e.xp6(6),e.hYB("placeholder","",t.reviewValidRanges.per.min+1," - ",t.reviewValidRanges.per.max,"%"),e.xp6(1),e.Q6J("collapse",!t.isFormError("performanceScore",t.talentToReview))("isAnimated",!0),e.xp6(1),e.hij(" ",t.prettifyError(t.talentToReview.formGroup.controls.performanceScore.errors)," "),e.xp6(5),e.Q6J("autoDisplayFirst",!1)("options",t.potentialRanges),e.xp6(1),e.Q6J("collapse",!t.isFormError("potentialScore",t.talentToReview))("isAnimated",!0),e.xp6(1),e.hij(" ",t.prettifyError(t.talentToReview.formGroup.controls.potentialScore.errors)," ")}}class re{constructor(r,t,i,s,m,R){this.formVisible=!0,this.hasReview=!1,this.canAddReview=!1,this.isEmployed=!1,this.saved=!1,this.talentInfo=r,this.formGroup=t,this.hasReview=i,this.canAddReview=s,this.isEmployed=m,void 0!==R&&(this.assignedEvDefinition=R)}setReviewValues(){this.formGroup.markAllAsTouched(),this.formReviewValue={performanceScore:this.formGroup.get("performanceScore")?.value,potentialScore:this.formGroup.get("potentialScore")?.value}}}let ae=(()=>{class n{constructor(){this.legacyValueChanges=new e.vpe,this.legacyStatusChanges=new e.vpe,this.potentialRanges=[{value:1,display:"Low"},{value:2,display:"Medium"},{value:3,display:"High"}],this.reviewValidRanges={per:{min:0,max:100},pot:{min:0,max:3}},this.subscriptions=new O.w0}ngOnInit(){this.subscriptions.add(this.talentToReview?.formGroup.valueChanges.pipe((0,v.b)(350)).subscribe(t=>{this.legacyValueChanges.emit(t)})),this.subscriptions.add(this.talentToReview?.formGroup.statusChanges.pipe((0,v.b)(350)).subscribe(t=>{this.legacyStatusChanges.emit(t)}))}isFormError(t,i){const s=i.formGroup.get(t);return!s?.pristine&&!s?.valid}prettifyError(t){return t?t.required?"Required":t.min||t.max?"Invalid":t.notNumeric?"Not number":t.notInteger?"Contains decimal":"":""}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["alasta-create-basic-review"]],inputs:{talentToReview:"talentToReview"},outputs:{legacyValueChanges:"legacyValueChanges",legacyStatusChanges:"legacyStatusChanges"},decls:1,vars:1,consts:[["class","form-row",4,"ngIf"],[1,"form-row"],[1,"col-12","p-4"],["autocomplete","off",3,"formGroup"],[1,"form-row","align-items-start"],[1,"col-12","col-sm-6","col-md-6","p-2","px-4"],["for","performanceScore",1,"block","mb-0"],[1,"p-fluid"],["pInputText","","formControlName","performanceScore","id","performanceScore","name","performanceScore","aria-describedby","performanceInvalid","autocomplete","off","type","number",3,"placeholder"],["id","performanceInvalid",1,"p-error","block",3,"collapse","isAnimated"],[1,"col-12","col-sm-6","col-md-6","p-2"],["for","potentialScore",1,"block","mb-0"],["formControlName","potentialScore","placeholder","Select Potential","optionLabel","display","optionValue","value",3,"autoDisplayFirst","options"],["id","potentialInvalid",1,"p-error","block",3,"collapse","isAnimated"]],template:function(t,i){1&t&&e.YNc(0,oe,18,11,"div",0),2&t&&e.Q6J("ngIf",i.talentToReview)},dependencies:[d.O5,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.sg,l.u,G.Y,J.o,k.Lt]}),n})();var se=a(921),B=a(527);class le{constructor(r){this.idToValidatorMap=new Map;for(const t of r)this.idToValidatorMap.set(t.id,this.validatorFromRule(t))}getValidator(r){return this.idToValidatorMap.get(r)??this.defaultValidatorFn()}validatorFromRule(r){switch(r.type){case"required":return l.kI.required;case"gt":return B.d.greaterThanValidator(Number(r.value));case"gte":return l.kI.min(Number(r.value));case"lt":return B.d.lessThanValidator(Number(r.value));case"lte":return l.kI.max(Number(r.value));case"min_length":return l.kI.minLength(Number(r.value));case"max_length":return l.kI.maxLength(Number(r.value));case"pattern":return l.kI.pattern(String(r.value));case"is_numeric":return B.d.isNumeric();default:return this.defaultValidatorFn()}}defaultValidatorFn(){return()=>null}}function ce(n,r){1&n&&(e.TgZ(0,"small",10),e._uU(1,"optional"),e.qZA())}function ue(n,r){if(1&n&&(e.TgZ(0,"div",4)(1,"span")(2,"label",5),e._uU(3),e.YNc(4,ce,2,0,"small",6),e.qZA()(),e.TgZ(5,"div",7),e._UZ(6,"input",8),e.TgZ(7,"small",9),e._uU(8),e.qZA()()()),2&n){const t=e.oxw();e.xp6(2),e.uIk("for",t.definition.id),e.xp6(1),e.hij(" ",t.definition.label," "),e.xp6(1),e.Q6J("ngIf",t.definition.optional),e.xp6(2),e.Q6J("formControlName",t.definition.id)("id",t.definition.id)("type",t.definition.type)("name",t.definition.id),e.xp6(1),e.Q6J("collapse",!t.isFormError(t.definition.id))("isAnimated",!0),e.xp6(1),e.hij(" ",t.prettifyError(t.definition.id)," ")}}function de(n,r){1&n&&(e.TgZ(0,"small",10),e._uU(1,"optional"),e.qZA())}function me(n,r){if(1&n&&(e.TgZ(0,"div",11)(1,"label",5),e._uU(2),e.YNc(3,de,2,0,"small",6),e.qZA(),e.TgZ(4,"div",7),e._UZ(5,"textarea",12),e.TgZ(6,"small",9),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("for",t.definition.id),e.xp6(1),e.hij(" ",t.definition.label," "),e.xp6(1),e.Q6J("ngIf",t.definition.optional),e.xp6(2),e.Q6J("formControlName",t.definition.id)("id",t.definition.id)("name",t.definition.id),e.xp6(1),e.Q6J("collapse",!t.isFormError(t.definition.id))("isAnimated",!0),e.xp6(1),e.hij(" ",t.prettifyError(t.definition.id)," ")}}let pe=(()=>{class n{constructor(){}ngOnInit(){}get isInvalid(){return!this.form?.controls[this.definition.id].valid&&this.form?.controls[this.definition.id].touched||!1}isFormError(t){const i=this.form?.get(t);return!i?.pristine&&!i?.valid}prettifyError(t){const i=this.form?.get(t),s=i?.errors;return s?s.required?"Required":s.greaterThan?"Must be greater than "+i.errors.greaterThan.greaterThan:s.min?"Must be greater than or equal to "+i.errors.min.min:s.lessThan?"Must be less than "+i.errors.lessThan.lessThan:s.max?"Must be less than or equal to "+i.errors.max.max:s.minlength?"Too short. Needs at least "+i.errors.minlength.requiredLength+" characters":s.maxlength?"Too long. Needs at most "+i.errors.maxlength.requiredLength+" characters":s.pattern?"Not valid":s.notNumeric?"Not a number":"":""}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["alasta-form-element"]],inputs:{definition:"definition",form:"form"},decls:4,vars:4,consts:[[3,"formGroup"],[3,"ngSwitch"],["class","field my-2 d-flex justify-content-between",4,"ngSwitchCase"],["class","field my-2",4,"ngSwitchCase"],[1,"field","my-2","d-flex","justify-content-between"],[1,"block","mb-0"],["class","text-muted",4,"ngIf"],[1,"p-fluid"],["pInputText","","autocomplete","off",3,"formControlName","id","type","name"],[1,"p-error","block",3,"collapse","isAnimated"],[1,"text-muted"],[1,"field","my-2"],["pInputText","","autocomplete","off",3,"formControlName","id","name"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,ue,9,10,"div",2),e.YNc(3,me,8,9,"div",3),e.qZA()()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngSwitch",i.definition.type),e.xp6(1),e.Q6J("ngSwitchCase","number"),e.xp6(1),e.Q6J("ngSwitchCase","text"))},dependencies:[d.O5,d.RF,d.n9,l.Fj,l.JJ,l.JL,l.sg,l.u,G.Y,J.o],styles:[".errorMessage[_ngcontent-%COMP%]{font-size:small;color:red}"]}),n})();function fe(n,r){if(1&n&&(e.TgZ(0,"div",2),e._UZ(1,"alasta-form-element",3),e.qZA()),2&n){const t=r.$implicit,i=e.oxw();e.xp6(1),e.Q6J("definition",t)("form",i.form)}}let he=(()=>{class n{constructor(){}ngOnInit(){for(const t of this.definition.elements){const i=t.validators?.map(m=>this.validatorFactory.getValidator(m))||[],s=this.withValues?.elements.find(m=>m.id===t.id)?.value??"";this.form.addControl(t.id,t.optional?new l.NI(s):new l.NI(s,[l.kI.required,...i]))}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["alasta-form-group"]],inputs:{definition:"definition",withValues:"withValues",form:"form",validatorFactory:"validatorFactory"},decls:5,vars:3,consts:[[1,"m-2"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[3,"definition","form"]],template:function(t,i){1&t&&(e.TgZ(0,"h5"),e._uU(1),e.qZA(),e.TgZ(2,"h6",0),e._uU(3),e.qZA(),e.YNc(4,fe,2,2,"div",1)),2&t&&(e.xp6(1),e.Oqu(i.definition.title),e.xp6(2),e.Oqu(i.definition.description),e.xp6(1),e.Q6J("ngForOf",i.definition.elements))},dependencies:[d.sg,pe]}),n})();function ve(n,r){1&n&&(e.TgZ(0,"span",11),e._UZ(1,"i",12),e.TgZ(2,"em"),e._uU(3," Section incomplete"),e.qZA()())}function _e(n,r){if(1&n&&e._UZ(0,"alasta-form-group",15),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("definition",t)("form",i.getFormGroup(t.id))("withValues",i.getFormGroupWithValues(t.id))("validatorFactory",i.validatorFactory)}}function ge(n,r){if(1&n&&(e.TgZ(0,"div",13),e.YNc(1,_e,1,4,"alasta-form-group",14),e.qZA()),2&n){const t=r.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",null!==i.getFormGroup(t.id))}}const Te=function(n,r){return{"btn-primary":n,"btn-light":r}},Ee=function(n,r){return{"fa-chevron-up":n,"fa-chevron-down":r}};let Ie=(()=>{class n{constructor(){this.visible=!1}ngOnInit(){for(const t of this.definition.formGroups)this.form.addControl(t.id,t.optional?new l.cw([]):new l.cw([],l.kI.required))}getFormGroup(t){return this.form.get(t)}getFormGroupWithValues(t){return this.withValues?.formGroups.find(i=>i.id===t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["alasta-form"]],inputs:{definition:"definition",withValues:"withValues",form:"form",validatorFactory:"validatorFactory"},decls:12,vars:15,consts:[[1,"form-row","shadow-sm","rounded","m-1"],[1,"col","my-2"],[1,"form-row","align-items-center"],[1,"col-auto"],[1,"btn","rounded-pill","text-center",3,"ngClass","click"],["aria-hidden","true",1,"fa",3,"ngClass"],[1,"my-1"],["class","h6",4,"ngIf"],[1,"col-12"],[3,"collapse","isAnimated"],["class","px-4 py-2",4,"ngFor","ngForOf"],[1,"h6"],[1,"fa","fa-exclamation-triangle","text-warning"],[1,"px-4","py-2"],[3,"definition","form","withValues","validatorFactory",4,"ngIf"],[3,"definition","form","withValues","validatorFactory"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),e.NdJ("click",function(){return i.visible=!i.visible}),e._UZ(5,"i",5),e.qZA()(),e.TgZ(6,"h4",6),e._uU(7),e.YNc(8,ve,4,0,"span",7),e.qZA(),e.TgZ(9,"div",8)(10,"div",9),e.YNc(11,ge,2,1,"div",10),e.qZA()()()()()),2&t&&(e.xp6(4),e.Udp("font-size",100,"%"),e.Q6J("ngClass",e.WLB(9,Te,!i.form.valid,i.form.valid)),e.xp6(1),e.Q6J("ngClass",e.WLB(12,Ee,i.visible,!i.visible)),e.xp6(2),e.hij(" ",i.definition.title," "),e.xp6(1),e.Q6J("ngIf",i.form.touched&&!i.form.valid&&!i.visible),e.xp6(2),e.Q6J("collapse",!i.visible)("isAnimated",!0),e.xp6(1),e.Q6J("ngForOf",i.definition.formGroups))},dependencies:[d.mk,d.sg,d.O5,G.Y,he],styles:[".border-gray[_ngcontent-%COMP%]{border-color:#e7e7e7!important}"]}),n})();function Re(n,r){if(1&n&&e._UZ(0,"alasta-form",2),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("definition",t)("form",i.getFormGroup(t.id))("withValues",i.getFormWithValues(t.id))("validatorFactory",i.validatorFactory)}}function Ae(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Re,1,4,"alasta-form",1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",null!==i.getFormGroup(t.id))}}let Ce=(()=>{class n{constructor(){this.valueChanges=new e.vpe,this.statusChanges=new e.vpe,this.subscriptions=new O.w0,this.form=new l.cw([])}ngOnInit(){let t=new l.cw([]);for(const i of this.definition.forms)t.addControl(i.id,i.optional?new l.cw([]):new l.cw([],l.kI.required));this.form=t,this.validatorFactory=new le(this.definition.validationRules||[]),this.subscriptions.add(this.form.valueChanges.pipe((0,v.b)(350)).subscribe(i=>{this.valueChanges.emit(this.mapValuesToForm(i))})),this.subscriptions.add(this.form.statusChanges.pipe((0,v.b)(350)).subscribe(i=>{this.statusChanges.emit(i)}))}mapValuesToForm(t){let i={id:this.definition.id,filledForms:[]};for(const[s,m]of Object.entries(t)){let R={id:s,formGroups:[]};for(const[T,F]of Object.entries(m)){let g={id:T,elements:[]};for(const[L,W]of Object.entries(F))g.elements.push({id:L,value:W});R.formGroups.push(g)}i.filledForms.push(R)}return i}getFormGroup(t){return this.form.get(t)}getFormWithValues(t){return this.withValues?.filledForms.find(i=>i.id===t)}getResults(){let t={id:this.definition.id,filledForms:[]};for(const i in this.form.value){let s=this.form.value[i],m={id:i,formGroups:[]};for(const R in s){let T=s[R],F={id:R,elements:[]};for(const g in T)F.elements.push({id:g,value:T[g]});m.formGroups.push(F)}t.filledForms.push(m)}return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["alasta-form-view"]],inputs:{definition:"definition",withValues:"withValues"},outputs:{valueChanges:"valueChanges",statusChanges:"statusChanges"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"definition","form","withValues","validatorFactory",4,"ngIf"],[3,"definition","form","withValues","validatorFactory"]],template:function(t,i){1&t&&e.YNc(0,Ae,2,1,"div",0),2&t&&e.Q6J("ngForOf",i.definition.forms)},dependencies:[d.sg,d.O5,Ie]}),n})();function Se(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"alasta-form-view",14),e.NdJ("statusChanges",function(s){e.CHM(t);const m=e.oxw();return e.KtG(m.currentStatus=s)})("valueChanges",function(s){e.CHM(t);const m=e.oxw();return e.KtG(m.handleEvaluationFormUpdate(s))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("definition",t.formView)("withValues",t.withValues)}}function we(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"alasta-create-basic-review",15),e.NdJ("legacyStatusChanges",function(s){e.CHM(t);const m=e.oxw();return e.KtG(m.legacyCurrentStatus=s)})("legacyValueChanges",function(s){e.CHM(t);const m=e.oxw();return e.KtG(m.handleLegacyFormUpdate(s))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("talentToReview",t.basicReviewForm)}}let Oe=(()=>{class n{constructor(t,i,s,m){this.talentReviewApi=t,this.sessionStateService=i,this.fb=s,this.talentMapBoxService=m,this.processing=!1,this.onSumbit=new e.vpe,this.onCloseModal=new e.vpe,this.potentialRanges=[{value:1,display:"Low"},{value:2,display:"Medium"},{value:3,display:"High"}],this.reviewValidRanges={per:{min:0,max:0},pot:{min:0,max:0}}}ngOnInit(){var t=this;return(0,_.Z)(function*(){yield t.getBoxesInfo(),t.getEvaluationForm()})()}getEvaluationForm(){var t=this;return(0,_.Z)(function*(){if(!t.talentInfo)return void console.warn("talentInfo is not defined");let i=yield t.talentReviewApi.obtainEvaluationDefinitionForTalents([t.talentInfo.talentId]);if(void 0!==i.evaluationDefinitions&&i.evaluationDefinitions?.length>0&&(t.formView=i.evaluationDefinitions[0]),void 0!==i.employments&&i.employments?.length>0){let s,F,m=!0,R=!1,T=i.employments[0],g=T.isEmployed;s={talentId:T.talent?._id,talentName:T.talent?.name,...g?{position:T.job?.position?.name}:{},...g?{positionId:T.job?.position?._id}:{},...g?{property:T.job?.property?.name}:{},...g?{propertyId:T.job?.property?._id}:{},...g&&!T.isLegacy?{activeEmploymentId:T._id}:{}},T.job?.position?.evaluationFormId&&(F=T.job?.position?.evaluationFormId),g&&(m=t.canAddReview(s.propertyId,s.talentId));let L=t.fb.group({performanceScore:[{value:null,disabled:!m||R||!g},[l.kI.required,q.d.isInteger(),l.kI.min(t.reviewValidRanges.per.min+1),l.kI.max(t.reviewValidRanges.per.max)]],potentialScore:[{value:null,disabled:!m||R||!g},[l.kI.required,q.d.isInteger(),l.kI.min(t.reviewValidRanges.pot.min),l.kI.max(t.reviewValidRanges.pot.max)]]});m?g||L.setErrors({notSaved:{message:"Cannot add review to this talent: Talent is not currently employed"}}):L.setErrors({notSaved:{message:"Cannot add review to this talent: You lack the permissions to add a review to this talent"}}),t.basicReviewForm=new re(s,L,R,m,g,F)}})()}canAddReview(t,i){let s=this.currentUserResponsibility?.activeJob?this.currentUserResponsibility?.activeJob.property._id:this.currentUser?.talent?.location;switch(this.currentUser?.role){case S.u.SUPER_ADMIN:case S.u.ADMIN:return!0;case S.u.MANAGER:return s===t;case S.u.EMPLOYEE:return s===t&&this.currentUser.id!==i;default:return!1}}handleEvaluationFormUpdate(t){this.processing=!1,this.currentValue=t,this.sessionStateService.registerActivity()}handleLegacyFormUpdate(t){this.processing=!1,this.legacyCurrentValue=t,this.sessionStateService.registerActivity()}getBoxesInfo(){this.talentMapBoxService.getBoxes().then(t=>{t.boxes.length>0&&(this.reviewValidRanges={per:{max:t.boxes.find(i=>8===i.pos)?.perRng.high||100,min:t.boxes.find(i=>0===i.pos)?.perRng.low||0},pot:{max:t.boxes.find(i=>0===i.pos)?.potRng.high||3,min:t.boxes.find(i=>8===i.pos)?.potRng.low||0}})})}submitReview(){this.processing=!0,this.onSumbit.emit(void 0!==this.formView?{type:"evaluationForm",value:this.currentValue}:{type:"legacyReview",value:this.legacyCurrentValue})}disableButton(){return void 0!==this.formView?"VALID"!==this.currentStatus||this.processing:"VALID"!==this.legacyCurrentStatus||this.processing}setTestValues(){this.withValues={id:"exampleDefinition",filledForms:[{id:"competencies",formGroups:[{id:"formGroup1",elements:[{id:"cf1",value:80},{id:"cf2",value:40}]},{id:"formGroup2",elements:[{id:"ro1",value:80},{id:"ro2",value:40},{id:"ro3",value:40}]},{id:"formGroup3",elements:[{id:"r1",value:80}]}]},{id:"objectives",formGroups:[{id:"formGroup4",elements:[{id:"gs1",value:80}]},{id:"formGroup5",elements:[{id:"fr1",value:80}]}]},{id:"potential",formGroups:[{id:"formGroup6",elements:[{id:"se1",value:1}]},{id:"formGroup7",elements:[{id:"c1",value:2}]}]},{id:"comments",formGroups:[{id:"formGroup8",elements:[{id:"commentFromEvaluator",value:"Talent is masterful"}]}]}]}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(M.f),e.Y36(se.W),e.Y36(l.QS),e.Y36(z.M))},n.\u0275cmp=e.Xpm({type:n,selectors:[["alasta-evaluation-form-modal"]],inputs:{processing:"processing",talentInfo:"talentInfo",currentUser:"currentUser",currentUserResponsibility:"currentUserResponsibility"},outputs:{onSumbit:"onSumbit",onCloseModal:"onCloseModal"},decls:26,vars:7,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"mx-3"],[1,"mb-2"],[1,"pr-1"],[3,"definition","withValues","statusChanges","valueChanges",4,"ngIf"],[3,"talentToReview","legacyStatusChanges","legacyValueChanges",4,"ngIf"],[1,"modal-footer"],[1,"text-right"],[1,"btn","btn-primary","ml-1",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-save"],[3,"definition","withValues","statusChanges","valueChanges"],[3,"talentToReview","legacyStatusChanges","legacyValueChanges"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h4",1)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"button",2),e.NdJ("click",function(m){return i.onCloseModal.emit(m)}),e.TgZ(5,"span",3),e._uU(6,"\xd7"),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"h5"),e._uU(10,"Job:"),e.qZA(),e.TgZ(11,"h6",6)(12,"strong",7),e._uU(13,"Position:"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"h6")(16,"strong",7),e._uU(17,"Property:"),e.qZA(),e._uU(18),e.qZA()(),e.YNc(19,Se,1,2,"alasta-form-view",8),e.YNc(20,we,1,1,"alasta-create-basic-review",9),e.qZA(),e.TgZ(21,"div",10)(22,"div",11)(23,"button",12),e.NdJ("click",function(){return i.submitReview()}),e._UZ(24,"i",13),e._uU(25," Submit Review "),e.qZA()()()),2&t&&(e.xp6(3),e.AsE("Add Review for ",null==i.talentInfo||null==i.talentInfo.talentName?null:i.talentInfo.talentName.given," ",null==i.talentInfo||null==i.talentInfo.talentName?null:i.talentInfo.talentName.last,""),e.xp6(11),e.hij(" ",null==i.talentInfo?null:i.talentInfo.position,""),e.xp6(4),e.hij(" ",null==i.talentInfo?null:i.talentInfo.property,""),e.xp6(1),e.Q6J("ngIf",void 0!==i.formView),e.xp6(1),e.Q6J("ngIf",i.basicReviewForm&&void 0===i.formView),e.xp6(3),e.Q6J("disabled",i.disableButton()))},dependencies:[d.O5,Ce,ae]}),n})();var K=a(4358);const De=["searchInput"];function ye(n,r){1&n&&(e.TgZ(0,"alert",20),e._uU(1,"You can now add evaluations directly in Keiro, find the Talent and click the blue button by their name."),e.qZA()),2&n&&e.Q6J("dismissible",!0)}function Ne(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",21)(1,"button",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.addReview())}),e._UZ(2,"i",23),e._uU(3),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.selectedRows.length),e.xp6(2),e.hij(" Review selected (",t.selectedRows.length,") ")}}function Fe(n,r){1&n&&(e.TgZ(0,"th"),e._uU(1,"Review"),e.qZA())}function Me(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,Fe,2,0,"th",16),e.TgZ(2,"th"),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"th"),e._uU(5,"Property"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Position"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Department"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Area"),e.qZA(),e._UZ(12,"th"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.currentRWExists)}}function be(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,m=e.oxw(),R=e.MAs(22);return m.talentToReview=s,e.KtG(m.modalsController.openExtraLargeModal(R,{ignoreBackdropClick:!0,keyboard:!1}))}),e.qZA()}}function Ue(n,r){if(1&n&&(e.TgZ(0,"td"),e.YNc(1,be,1,0,"button",25),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.canSelectTalent(t))}}const xe=function(n){return["..","view",n]};function Ve(n,r){if(1&n&&e._UZ(0,"a",27),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(1,xe,t.talentId))}}function Pe(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,Ue,2,1,"td",16),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e.YNc(13,Ve,1,3,"a",24),e.qZA()()),2&n){const t=r.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.currentRWExists),e.xp6(2),e.AsE("",(null==t.talentName?null:t.talentName.given)||""," ",(null==t.talentName?null:t.talentName.last)||"",""),e.xp6(2),e.Oqu(t.property||""),e.xp6(2),e.Oqu(t.position||""),e.xp6(2),e.Oqu(t.department||""),e.xp6(2),e.Oqu(t.area||""),e.xp6(2),e.Q6J("ngIf",i.canViewTalent(t))}}function Le(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("(",t.selectedRows.length," selected)")}}function Ze(n,r){if(1&n&&(e.TgZ(0,"small"),e._uU(1),e.YNc(2,Le,2,1,"span",16),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij("",t.total," total "),e.xp6(1),e.Q6J("ngIf",t.selectedRows.length)}}function Ye(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",29),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.streamExcelFile())}),e.qZA()}}function Ge(n,r){1&n&&e.YNc(0,Ye,1,0,"ng-template",28)}function Je(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.addReview())}),e._UZ(1,"i",23),e._uU(2),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.hij(" Review selected (",t.selectedRows.length,") ")}}function Be(n,r){1&n&&(e.TgZ(0,"p",31)(1,"strong"),e._uU(2,"Please note:"),e.qZA(),e._uU(3," Talents can only be selected if they don't have a review yet. To update a review, please contact your Keiro administrator."),e.qZA())}function We(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"alasta-evaluation-form-modal",32),e.NdJ("onCloseModal",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.modalsControllerService.closeUpperModal())})("onSumbit",function(s){e.CHM(t);const m=e.oxw();return e.KtG(m.reviewTalent(s))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("processing",t.isProcessing)("talentInfo",t.talentToReview)("currentUser",t.currentUser)("currentUserResponsibility",t.currentUserResponsibility)}}const je=function(){return[10,25,50]};var I=(()=>{return(n=I||(I={}))[n.REVIEW_CYCLE=0]="REVIEW_CYCLE",n[n.MAP_POSITION=1]="MAP_POSITION",n[n.COUNTRY=2]="COUNTRY",n[n.PROPERTY=3]="PROPERTY",n[n.AREA=4]="AREA",n[n.DEPARTMENT=5]="DEPARTMENT",n[n.POSITION=6]="POSITION",I;var n})();let Qe=(()=>{class n{constructor(t,i,s,m,R,T,F,g,L,W,j,$e,et,tt,it,nt){this.filterService=t,this.route=i,this.router=s,this.modalsControllerService=m,this.authStateService=R,this.store=T,this.talentService=F,this.reviewService=g,this.modalsController=L,this.teamService=W,this.talentsManagementApi=j,this.locationsApi=$e,this.positionsApi=et,this.reviewCycleServiceApi=tt,this.talentMapBoxesApi=it,this.messageService=nt,this.today=new x.p,this.canDownloadExcel=!1,this.total=0,this.page=0,this.step=25,this.rows=[],this.selectedRows=[],this.searchInputControl=new l.p4,this.loadingIndicator=!0,this.subscriptions=new O.w0,this.filterValue={},this.isProcessing=!1,this.callTalentFinderSubject=new o.x,this.isRowSelectable=b=>this.canSelectTalent(b.data),this.subscriptions.add(this.callTalentFinderSubject.pipe((0,u.U)(b=>(this.loadingIndicator=!0,b)),(0,v.b)(150)).subscribe(()=>this.fetchTalentsWithSearch())),this.fetchLocations(),this.fetchPositions(),this.fetchCurrentReviewCycle(),this.fetchReviewWindows(),this.fetchTalentMapPositions(),this.fetchActiveResponsiblity(),this.subscriptions.add(this.authStateService.authState.subscribe(b=>{b.identity&&(this.currentUser=b.identity),this.canDownloadExcel=this.currentUser?.role==S.u.SUPER_ADMIN||this.currentUser?.role==S.u.ADMIN})),this.subscriptions.add(this.searchInputControl.valueChanges.pipe((0,v.b)(250)).subscribe(b=>{this.searchInputControl.valid&&(this.callTalentFinderSubject.next(void 0),this.router.navigate([],{relativeTo:this.route,queryParams:{q:encodeURIComponent(b)},queryParamsHandling:"merge",replaceUrl:!0}))}))}ngOnInit(){(0,c.z)(this.route.queryParams).then(t=>{if(t.f){const i=w.F.decodeURLParamToObject(t.f);this.filterService.addFilterValues(i)}if(t.q){const i=decodeURIComponent(t.q);this.searchInputControl.setValue(i)}}),this.filterService.valueChange.subscribe(t=>{const i=this.filterValue;this.filterValue=t,this.callTalentFinderSubject.next(void 0),this.router.navigate([],{relativeTo:this.route,queryParams:{f:w.F.encodeObjectToURLParam(t)},queryParamsHandling:"merge",replaceUrl:!0}),(this.filterValue.country!=i.country||this.filterValue.location!=i.location)&&this.fetchLocations(),(this.filterValue.area!=i.area||this.filterValue.department!=i.department||this.filterValue.position!=i.position)&&this.fetchPositions()})}ngAfterViewInit(){this.input?.nativeElement.focus()}ngOnDestroy(){this.subscriptions.unsubscribe()}streamExcelFile(){this.talentsManagementApi.downloadTalentsFilterSearch(this.searchInputControl?.value,this.filterValue?.windowRId,this.filterValue?.boxPosition,this.filterValue?.country,this.filterValue?.location,this.filterValue?.area,this.filterValue?.department,this.filterValue?.position)}onSelectionChange(t){this.selectedRows=t}setPage(t){this.step=t.rows,this.page=Math.floor(t.first/t.rows),this.callTalentFinderSubject.next(void 0)}canSelectTalent(t){let i=this.currentUserResponsibility?.activeJob?this.currentUserResponsibility?.activeJob.property._id:this.currentUser?.talent?.location;return!(void 0===t.positionId&&void 0===t.propertyId||!this.currentRWExists||this.currentReviewCycle?._id&&t.reviewedDuringCycles?.includes(this.currentReviewCycle._id)||this.currentUser?.role===S.u.EMPLOYEE&&this.currentUser?.id===t.talentId||(this.currentUser?.role===S.u.EMPLOYEE||this.currentUser?.role===S.u.MANAGER)&&i!==t.propertyId)}canViewTalent(t){return!0}onSelect(t){const i=t.selected;this.selectedRows.splice(0,this.selectedRows.length),this.selectedRows.push(...i)}addReview(){this.store.dispatch((0,U.KD)({talents:this.selectedRows})),this.router.navigate(["app","review","create"])}fetchTalentsWithSearch(){this.loadingIndicator=!0,this.talentsManagementApi.findTalentsFilterSearch(this.step,this.page+1,this.searchInputControl?.value,this.filterValue?.windowRId,this.filterValue?.boxPosition,this.filterValue?.country,this.filterValue?.location,this.filterValue?.area,this.filterValue?.department,this.filterValue?.position).then(t=>{this.rows=t.talents,this.total=t.total}).finally(()=>{this.loadingIndicator=!1})}fetchLocations(){this.locationsApi.findDistinctLocations(this.filterValue.country||void 0,this.filterValue.location||void 0).then(t=>{const i=this.filterService.getMetadataWithId(I.COUNTRY.toString()),s=t.countries.map(T=>({name:T,value:T}));i.options=s;const m=this.filterService.getMetadataWithId(I.PROPERTY.toString()),R=t.properties.map(T=>({name:T,value:T}));m.options=R}).catch(t=>{console.error(t)})}fetchPositions(){this.positionsApi.findDistinctPositions(this.filterValue.area||void 0,this.filterValue.department||void 0,this.filterValue.position||void 0).then(t=>{const i=this.filterService.getMetadataWithId(I.AREA.toString()),s=t.areas.map(g=>({name:g,value:g}));i.options=s;const m=this.filterService.getMetadataWithId(I.DEPARTMENT.toString()),R=t.departments.map(g=>({name:g,value:g}));m.options=R;const T=this.filterService.getMetadataWithId(I.POSITION.toString()),F=t.positions.map(g=>({name:g,value:g}));T.options=F}).catch(t=>{console.error(t)})}fetchReviewWindows(){this.reviewCycleServiceApi.getAllReviewCycles().then(t=>{const i=this.filterService.getMetadataWithId(I.REVIEW_CYCLE.toString()),s=t.reviewCycles.sort((m,R)=>Date.parse(R.startDate)-Date.parse(m.startDate)).map(m=>({name:m.name,value:m._id}));i.options=s,!this.filterValue.windowRId&&i?.required&&this.filterService.addFilterWithId(I.REVIEW_CYCLE.toString(),s[0]?.value)}).catch(t=>{console.error(t)})}fetchCurrentReviewCycle(){this.reviewCycleServiceApi.getCurrentReviewCycle().then(t=>{this.currentReviewCycle=t.reviewCycle?t.reviewCycle:void 0,this.currentRWExists=void 0!==this.currentReviewCycle}).catch(t=>{console.error(t)})}fetchTalentMapPositions(){this.talentMapBoxesApi.getBoxes().then(t=>{const i=this.filterService.getMetadataWithId(I.MAP_POSITION.toString()),s=t.boxes.sort((m,R)=>m.title[m.title.length-1]-R.title[R.title.length-1]).map(m=>({name:m.title,value:""+m.pos}));i.options=s}).catch(t=>{console.error(t)})}fetchActiveResponsiblity(){var t=this;return(0,_.Z)(function*(){t.currentUserResponsibility=yield t.teamService.getOwnActiveResponsibiliy()})()}showSuccessMessage(t,i){this.messageService.add({severity:"success",summary:t,detail:i,life:3e3})}showErrorMessage(t,i){this.messageService.add({severity:"error",summary:t,detail:i,life:4e3})}reviewTalent(t){var i=this;return(0,_.Z)(function*(){if(i.isProcessing=!0,i.currentReviewCycle)try{if("evaluationForm"===t.type)yield i.saveReview(t.value,i.currentReviewCycle._id);else{if("legacyReview"!==t.type)throw new Error("Unrecognized review type");yield i.legacySaveReview(t.value,i.currentReviewCycle._id)}i.showSuccessMessage("Success","Review created successfully"),yield new Promise(s=>setTimeout(s,1e3)),i.modalsControllerService.closeUpperModal(),i.fetchTalentsWithSearch()}catch{i.showErrorMessage("Error","There was an error while reviewing this talent")}finally{i.isProcessing=!1}})()}legacySaveReview(t,i){let s={potential:t.potentialScore,performance:t.performanceScore,date:this.today.date,reviewCycle:i,talent:this.talentToReview.talentId,...this.talentToReview.activeEmploymentId?{employment:this.talentToReview.activeEmploymentId}:{}};return this.reviewService.addTalentReview(s)}saveReview(t,i){let s={evaluationForm:t,reviewCycle:i,talent:this.talentToReview.talentId,...this.talentToReview.activeEmploymentId?{employment:this.talentToReview.activeEmploymentId}:{}};return this.reviewService.evaluateWithForm(s)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.i),e.Y36(f.gz),e.Y36(f.F0),e.Y36(V.l),e.Y36(N.V),e.Y36(Y.yh),e.Y36(P.C),e.Y36(M.f),e.Y36(V.l),e.Y36(X.U),e.Y36($.C),e.Y36(ee._),e.Y36(te.m),e.Y36(ie.m),e.Y36(z.M),e.Y36(H.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-talent-finder"]],viewQuery:function(t,i){if(1&t&&e.Gf(De,5),2&t){let s;e.iGM(s=e.CRH())&&(i.input=s.first)}},features:[e._Bn([{provide:"filterConfiguration",useValue:{dropdownOptions:[{id:I.COUNTRY.toString(),name:"Country"},{id:I.PROPERTY.toString(),name:"Property"},{id:I.AREA.toString(),name:"Area"},{id:I.DEPARTMENT.toString(),name:"Department"},{id:I.POSITION.toString(),name:"Position"},{id:I.REVIEW_CYCLE.toString(),name:"Review cycle"},{id:I.MAP_POSITION.toString(),name:"Talent Map placement"}],filtersMetadata:[{id:I.REVIEW_CYCLE.toString(),type:A.v.DROPDOWN_SEARCH,visibleName:"Review Cycle",key:"windowRId",group:"Evaluation",children:[{id:I.MAP_POSITION.toString(),type:A.v.DROPDOWN_SEARCH,visibleName:"Talent Map Placement",key:"boxPosition",group:"Evaluation"}]},{id:I.AREA.toString(),type:A.v.DROPDOWN_SEARCH,visibleName:"Area",key:"area",group:"Job description",groupOrder:1},{id:I.DEPARTMENT.toString(),type:A.v.DROPDOWN_SEARCH,visibleName:"Department",key:"department",group:"Job description",groupOrder:2},{id:I.POSITION.toString(),type:A.v.DROPDOWN_SEARCH,visibleName:"Position",key:"position",group:"Job description",groupOrder:3},{id:I.COUNTRY.toString(),type:A.v.DROPDOWN_SEARCH,visibleName:"Country",key:"country",group:"Location",groupOrder:1},{id:I.PROPERTY.toString(),type:A.v.DROPDOWN_SEARCH,visibleName:"Property",key:"location",group:"Location",groupOrder:2}]}},{provide:C.i}])],decls:23,vars:18,consts:[[1,"animated","fadeIn"],["type","info",3,"dismissible",4,"ngIf"],[1,"card"],[1,"card-body"],[1,"form-row","justify-content-end"],[1,"col","mb-1"],[1,"has-search"],[1,"fa","fa-search","has-search-icon"],["type","text","placeholder","Search by name, email, or Keiro ID",1,"form-control",3,"formControl"],["searchInput",""],["class","col-12 col-sm-auto text-right mb-1",4,"ngIf"],[1,"d-block","mb-2",3,"service"],["styleClass","p-datatable-sm","responsiveLayout","scroll",3,"value","lazy","loading","paginator","rows","totalRecords","rowsPerPageOptions","selection","selectionPageOnly","rowSelectable","onLazyLoad","selectionChange"],["pTemplate","header"],["pTemplate","body"],["pTemplate","paginatorleft"],[4,"ngIf"],["class","btn btn-primary","title","Select some talents to add reviews",3,"click",4,"ngIf"],["class","mt-2",4,"ngIf"],["createTalentEvaluationModal",""],["type","info",3,"dismissible"],[1,"col-12","col-sm-auto","text-right","mb-1"],["title","Select some talents to add reviews",1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-chart-line","mr-1"],["pButton","","class","p-button-rounded p-button-secondary","icon","fa fa-external-link-alt",3,"routerLink",4,"ngIf"],["pButton","","icon","fas fa-tasks","class","p-button-outlined p-button-rounded",3,"click",4,"ngIf"],["pButton","","icon","fas fa-tasks",1,"p-button-outlined","p-button-rounded",3,"click"],["pButton","","icon","fa fa-external-link-alt",1,"p-button-rounded","p-button-secondary",3,"routerLink"],["pTemplate","paginatorright"],["icon","fa fa-file-excel","styleClass","p-button-outlined","type","button","pTooltip","Download as Excel file","tooltipPosition","left",3,"click"],["title","Select some talents to add reviews",1,"btn","btn-primary",3,"click"],[1,"mt-2"],[3,"processing","talentInfo","currentUser","currentUserResponsibility","onCloseModal","onSumbit"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,ye,2,1,"alert",1),e.TgZ(2,"div",2)(3,"div",3)(4,"h4"),e._uU(5,"Talent Finder"),e.qZA(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"span",7)(10,"input",8,9),e.qZA()(),e.YNc(12,Ne,4,2,"div",10),e.qZA(),e._UZ(13,"alasta-filters-list",11),e.TgZ(14,"p-table",12),e.NdJ("onLazyLoad",function(m){return i.setPage(m)})("selectionChange",function(m){return i.onSelectionChange(m)}),e.YNc(15,Me,13,1,"ng-template",13),e.YNc(16,Pe,14,8,"ng-template",14),e.YNc(17,Ze,3,2,"ng-template",15),e.YNc(18,Ge,1,0,null,16),e.qZA(),e.YNc(19,Je,3,1,"button",17),e.YNc(20,Be,4,0,"p",18),e.qZA()()(),e.YNc(21,We,1,4,"ng-template",null,19,e.W1O)),2&t&&(e.xp6(1),e.Q6J("ngIf",i.currentRWExists),e.xp6(9),e.Q6J("formControl",i.searchInputControl),e.xp6(2),e.Q6J("ngIf",i.currentRWExists&&i.selectedRows.length),e.xp6(1),e.Q6J("service",i.filterService),e.xp6(1),e.Q6J("value",i.rows)("lazy",!0)("loading",i.loadingIndicator)("paginator",!0)("rows",i.step)("totalRecords",i.total)("rowsPerPageOptions",e.DdM(17,je))("selection",i.selectedRows)("selectionPageOnly",!0)("rowSelectable",i.isRowSelectable),e.xp6(4),e.Q6J("ngIf",i.canDownloadExcel),e.xp6(1),e.Q6J("ngIf",i.currentRWExists&&i.selectedRows.length),e.xp6(1),e.Q6J("ngIf",i.currentRWExists))},dependencies:[f.yS,d.O5,l.Fj,l.JJ,l.oH,ne.a,E.iA,H.jx,h.Hq,h.zx,Q.u,Oe,K.wx],styles:[".has-search[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]{padding-left:2.375rem}.has-search[_ngcontent-%COMP%] > .has-search-icon[_ngcontent-%COMP%]{position:absolute;z-index:2;display:block;width:2.375rem;height:2.375rem;line-height:2.375rem;text-align:center;pointer-events:none;color:#aaa}"]}),n})(),qe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,l.UX,G.f,J.j]}),n})(),ke=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,l.UX,G.f,J.j,k.kW]}),n})(),Ke=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,qe,ke]}),n})(),Xe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[f.Bz.forChild([{path:"",component:Qe}]),d.ez,l.UX,y.z8.forRoot(),p.i,E.U$,h.hJ,Q.z,Ke,K.nM.forRoot()]}),n})()}}]);