"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[621],{9621:(mt,f,o)=>{o.r(f),o.d(f,{CreateTalentModule:()=>ct});var d=o(6895),m=o(2714),g=o(8816),C=o(433),A=o(4175),b=o(2320),x=o(8099),y=o(2306),Z=o(3345),u=o(5861),t=o(1571),S=o(727),h=o(7197),l=o(625),p=o(582),I=o(171),k=o(9649),N=o(2733),F=o(921),V=o(797),w=o(917),L=o(4053),J=o(2962),E=o(549),M=o(1507),U=o(5303);function Q(a,i){1&a&&(t.TgZ(0,"span",37),t._UZ(1,"app-shared-icon-tooltip",38),t.qZA())}function R(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const e=t.oxw(2).$implicit;t.xp6(1),t.AsE(" : ",null==e?null:e.currentTalentValue.firstNames," ",null==e?null:e.currentTalentValue.lastNames," ")}}function Y(a,i){if(1&a&&(t.TgZ(0,"span"),t.YNc(1,Q,2,0,"span",36),t.YNc(2,R,2,2,"span",19),t.qZA()),2&a){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngIf","INVALID"===e._talentStatus),t.xp6(1),t.Q6J("ngIf",n.ifTalentValueSet(e,"firstNames")&&n.ifTalentValueSet(e,"lastNames"))}}function O(a,i){1&a&&(t.TgZ(0,"div",39),t._UZ(1,"i",40),t.TgZ(2,"em"),t._uU(3,"Saved"),t.qZA()())}function W(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"button",41),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,r=t.oxw();return t.KtG(r.removeRow(s))}),t._UZ(1,"i",42),t._uU(2,"Remove entry "),t.qZA()}}const v=function(a){return["/","app","talent","view",a]};function $(a,i){if(1&a&&(t.TgZ(0,"a",43),t._uU(1," View in new tab "),t.qZA()),2&a){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,v,e.saved._id))}}function G(a,i){1&a&&(t.TgZ(0,"span"),t._uU(1," This form has not been completed yet "),t.qZA())}function K(a,i){1&a&&(t.TgZ(0,"span"),t._uU(1," There was a problem in the server while saving this talent "),t.qZA())}function H(a,i){if(1&a&&(t.TgZ(0,"div",44),t.YNc(1,G,2,0,"span",19),t.YNc(2,K,2,0,"span",19),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","INCOMPLETE"==e.error),t.xp6(1),t.Q6J("ngIf","SERVER_ERROR"==e.error)}}function P(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.removeLegacyWorkInfoSection())}),t._UZ(1,"i",46),t._uU(2,"Remove Employment "),t.qZA()}}function D(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"employment-forms-add-legacy-work",47),t.NdJ("valueChanges",function(s){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.currentLegacyWorkValue=s)})("statusChanges",function(s){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.legacyWorkStatus=s)}),t.qZA()}if(2&a){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("disabled",e.disabled)("positionOptions",n.positionOptions)("propertyOptions",n.propertyOptions)("touchForm",e.touch)}}function q(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.removeAccountSection())}),t._UZ(1,"i",48),t._uU(2,"Remove Keiro Access "),t.qZA()}}function j(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"keiro-account-form",49),t.NdJ("valueChanges",function(s){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.currentAccountValue=s)})("statusChanges",function(s){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.accountStatus=s)}),t.qZA()}if(2&a){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("disabled",e.disabled)("touchForm",e.touch)("canCreateRoles",n.canCreateRoles)}}function B(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit;return t.KtG(s.addLegacyWorkInfoSection())}),t._UZ(1,"i",46),t._uU(2,"Add Employment "),t.qZA()}}function z(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"button",54),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit;return t.KtG(s.addAccountSection())}),t._UZ(1,"i",55),t._uU(2,"Grant Keiro Access "),t.qZA()}}function X(a,i){if(1&a&&(t.TgZ(0,"div",50),t.YNc(1,B,3,0,"button",51),t.YNc(2,z,3,0,"button",52),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!e.showLegacyWorkInfo),t.xp6(1),t.Q6J("ngIf",e.canManageAccounts&&!e.showAlastaAccountSection)}}const tt=function(a,i){return{"fa-chevron-up":a,"fa-chevron-down":i}};function et(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div")(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15)(5,"button",16),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.KtG(r.formVisible=!r.formVisible)}),t.TgZ(6,"h6",17),t._UZ(7,"i",18),t.qZA()()(),t.TgZ(8,"div",4)(9,"em"),t._uU(10),t.qZA(),t.YNc(11,Y,3,2,"span",19),t.YNc(12,O,4,0,"div",20),t.qZA(),t.TgZ(13,"div",21),t.YNc(14,W,3,0,"button",22),t.YNc(15,$,2,3,"a",23),t.qZA()(),t.TgZ(16,"div",24),t.YNc(17,H,3,2,"div",25),t.TgZ(18,"div",26)(19,"h6",27),t._uU(20,"General information"),t.qZA(),t.TgZ(21,"talent-form",28),t.NdJ("valueChanges",function(s){const c=t.CHM(e).$implicit;return t.KtG(c.currentTalentValue=s)})("statusChanges",function(s){const c=t.CHM(e).$implicit;return t.KtG(c.talentStatus=s)}),t.qZA()(),t.TgZ(22,"div",29),t._UZ(23,"hr",30),t.TgZ(24,"h6",27),t._uU(25," Employment "),t.YNc(26,P,3,0,"button",31),t.qZA(),t.YNc(27,D,1,4,"employment-forms-add-legacy-work",32),t.qZA(),t.TgZ(28,"div",33),t._UZ(29,"hr",30),t.TgZ(30,"h6",27),t._uU(31," Keiro Account "),t.YNc(32,q,3,0,"button",31),t.qZA(),t.YNc(33,j,1,3,"keiro-account-form",34),t.qZA(),t.YNc(34,X,3,2,"div",35),t.qZA()()()()}if(2&a){const e=i.$implicit,n=i.index,s=t.oxw();t.xp6(1),t.Q6J("ngClass",e.cssClass),t.xp6(4),t.Udp("font-size",100,"%"),t.xp6(2),t.Q6J("ngClass",t.WLB(29,tt,e.formVisible,!e.formVisible)),t.xp6(3),t.hij("Talent form #",n+1,""),t.xp6(1),t.Q6J("ngIf",!e.formVisible),t.xp6(1),t.Q6J("ngIf",e.saved),t.xp6(2),t.Q6J("ngIf",!e.saved),t.xp6(1),t.Q6J("ngIf",e.saved),t.xp6(1),t.Q6J("collapse",!e.formVisible)("isAnimated",!0),t.xp6(1),t.Q6J("ngIf",e.error),t.xp6(4),t.Q6J("disabled",e.disabled)("allNationalities",s.allNationalities)("allLanguages",s.allLanguages)("touchForm",e.touch),t.xp6(1),t.Q6J("collapse",!e.showLegacyWorkInfo)("isAnimated",!0),t.xp6(1),t.Udp("width",85,"%"),t.xp6(3),t.Q6J("ngIf",!e.saved),t.xp6(1),t.Q6J("ngIf",e.showLegacyWorkInfo),t.xp6(1),t.Q6J("collapse",!e.showAlastaAccountSection)("isAnimated",!0),t.xp6(1),t.Udp("width",85,"%"),t.xp6(3),t.Q6J("ngIf",e.canManageAccounts&&!e.saved),t.xp6(1),t.Q6J("ngIf",e.showAlastaAccountSection),t.xp6(1),t.Q6J("ngIf",!e.saved)}}function nt(a,i){if(1&a&&(t.TgZ(0,"li",61)(1,"div",14)(2,"div",4),t._uU(3),t.qZA(),t.TgZ(4,"div",15)(5,"a",62),t._uU(6,"View talent in new tab"),t.qZA()()()()),2&a){const e=i.$implicit;t.xp6(3),t.AsE(" ",null==e.saved||null==e.saved.name?null:e.saved.name.given," ",null==e.saved||null==e.saved.name?null:e.saved.name.last," "),t.xp6(2),t.Q6J("routerLink",t.VKq(3,v,null==e||null==e.saved?null:e.saved._id))}}function at(a,i){if(1&a&&(t.TgZ(0,"div",58)(1,"h6",27),t._uU(2),t.qZA(),t.TgZ(3,"ul",59),t.YNc(4,nt,7,5,"li",60),t.qZA()()),2&a){const e=t.oxw(2);t.xp6(2),t.hij("Saved talents (",e.savedTalents.length,")"),t.xp6(2),t.Q6J("ngForOf",e.savedTalents)}}function st(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"bulk-save-progress-modal",56),t.NdJ("close",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.closeModal())}),t.YNc(1,at,5,2,"div",57),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("progress",e.savingProgress),t.xp6(1),t.Q6J("ngIf",0!==(null==e.savedTalents?null:e.savedTalents.length))}}class it{constructor(i){this.formVisible=!0,this.disabled=!1,this.defaultCssClass="border-secondary",this.cssClass=this.defaultCssClass,this.touch=new t.vpe,this.canManageAccounts=!0,this.showAlastaAccountSection=!1,this.showLegacyWorkInfo=!0,0===i.length&&(this.canManageAccounts=!1)}set currentTalentValue(i){this.error=void 0,this._currentTalentValue=i}get currentTalentValue(){return this._currentTalentValue}set talentStatus(i){this._talentStatus=i,this.updateCssClass()}set currentAccountValue(i){this.error=void 0,this._currentAccountValue=i}get currentAccountValue(){return this._currentAccountValue}set accountStatus(i){this._accountStatus=i,this.updateCssClass()}set currentLegacyWorkValue(i){this.error=void 0,this._currentLegacyWorkValue=i}get currentLegacyWorkValue(){return this._currentLegacyWorkValue}set legacyWorkStatus(i){this._legacyWorkStatus=i,this.updateCssClass()}addAccountSection(){this.showAlastaAccountSection=!0,this.updateCssClass()}removeAccountSection(){this.showAlastaAccountSection=!1,this.updateCssClass()}addLegacyWorkInfoSection(){this.showLegacyWorkInfo=!0,this.updateCssClass()}removeLegacyWorkInfoSection(){this.showLegacyWorkInfo=!1,this.updateCssClass()}updateCssClass(){"INVALID"!==this.getSimplifiedStatus()?this.saved?setTimeout(()=>{this.cssClass="border-success"}):setTimeout(()=>{this.cssClass=this.defaultCssClass}):setTimeout(()=>{this.cssClass="border-danger"})}getSimplifiedStatus(){return this.showAlastaAccountSection&&"INVALID"===this._accountStatus||this.showLegacyWorkInfo&&"INVALID"===this._legacyWorkStatus||"INVALID"===this._talentStatus?"INVALID":this._talentStatus}}let ot=(()=>{class a{constructor(e,n,s,r,c,_,ut,dt){this.router=e,this.authStateService=n,this.talentManagementServiceApi=s,this.modalsController=r,this.sessionStateService=c,this.locationsApi=_,this.positionsApi=ut,this.teamServiceApi=dt,this.inputTalentForms=[],this.allLanguages=[],this.allNationalities=[],this.positionOptions=[],this.propertyOptions=[],this.canCreateRolesString=[],this.canCreateRoles=[],this.canHideForm=!0,this.canHideAccountSection=!1,this.talentsToAddQueue=[],this.savingProgress=new p.j(0),this.savedTalents=[],this.subscriptions=new S.w0,this.subscriptions.add(this.authStateService.authState.subscribe(T=>{if(T.identity){if(this.currentUser=T.identity,"Admin"==this.currentUser.role)return void(this.canCreateRoles=[l.u.EMPLOYEE,l.u.MANAGER,l.u.ADMIN]);if("Manager"==this.currentUser.role)return void(this.canCreateRoles=[l.u.EMPLOYEE]);if("SuperAdmin"==this.currentUser.role)return void(this.canCreateRoles=[l.u.EMPLOYEE,l.u.MANAGER,l.u.ADMIN])}}))}ngOnInit(){var e=this;return(0,u.Z)(function*(){Promise.all([e.getAllLanguages(),e.getAllNationalities(),e.fetchLocations(),e.fetchPositions()]).then(n=>e.addNewRow()).catch(n=>e.handleFatalError())})()}ngOnDestroy(){this.subscriptions.unsubscribe()}prettifyError(e){return e?e.required?"Required":e.min||e.max?"Invalid":e.notInteger||e.notNumeric?"Not number":e.valueNotInOptions?"Unknown value":e.email?"Not valid email address":e.emailInUse?`Email address already in use by ${e.associatedTalent}`:e.minlength||e.maxlength?"Invalid length":e.matDatepickerMin||e.matDatepickerMax?"Invalid date":e.allOrNothing?"Incomplete work information":"":""}addNewRow(){this.sessionStateService.registerActivity();let e=new it(this.canCreateRoles);this.inputTalentForms.push(e)}removeRow(e){this.sessionStateService.registerActivity();const n=this.inputTalentForms.indexOf(e);this.inputTalentForms.splice(n,1);const s=this.savedTalents.indexOf(e);-1!=s&&this.savedTalents.splice(s,1)}ifTalentValueSet(e,n){return void 0!==e.currentTalentValue&&h.g.hasValue(e.currentTalentValue[n])}ifAccountValueSet(e,n){return void 0!==e.currentAccountValue&&h.g.hasValue(e.currentAccountValue[n])}saveTalents(e){this.sessionStateService.registerActivity(),this.talentsToAddQueue=this.inputTalentForms.filter(n=>!n.saved).map(n=>(n.error=void 0,n.touch.emit(),n)),this.savingProgress=new p.j(this.talentsToAddQueue.length),this.modalsController.openModal(e,{ignoreBackdropClick:!0,keyboard:!1}),this.saveNextTalent()}saveNextTalent(){var e=this;return(0,u.Z)(function*(){if(e.sessionStateService.registerActivity(),0==e.talentsToAddQueue.length)return;const n=e.talentsToAddQueue.shift();if(void 0!==n){if("VALID"!==n.getSimplifiedStatus())return n.error="INCOMPLETE",e.handleSaveFail(),void e.saveNextTalent();if(void 0!==n.currentTalentValue)try{const s=yield e.talentManagementServiceApi.createTalent(n.currentTalentValue,n.currentAccountValue);n.saved=s.talent,n.formVisible=!1,n.disabled=!0,n.showLegacyWorkInfo&&void 0!==n.currentLegacyWorkValue&&(yield e.teamServiceApi.addJobEmployment(n.currentLegacyWorkValue.propertyId,n.currentLegacyWorkValue.positionId,s.talent._id,n.currentLegacyWorkValue.startDate)),e.handleSaveSuccess(n),e.savedTalents.push(n)}catch{n.error="SERVER_ERROR",e.handleSaveFail()}finally{e.saveNextTalent()}}})()}handleSaveSuccess(e){this.savingProgress.incrementSuccessful(),e.disabled=!0}handleSaveFail(){this.savingProgress.incrementFailed()}handleFatalError(){alert("An error ocurred, please try again"),this.router.navigate(["app/talent/finder"])}closeModal(){this.modalsController.closeUpperModal()}getAllLanguages(){var e=this;return(0,u.Z)(function*(){const n=yield e.talentManagementServiceApi.getSupportedLanguages();e.allLanguages=n.languages})()}getAllNationalities(){var e=this;return(0,u.Z)(function*(){const n=yield e.talentManagementServiceApi.getSupportedCountries();e.allNationalities=n.countries})()}fetchLocations(){var e=this;return(0,u.Z)(function*(){const n=yield e.locationsApi.getAllProperties();e.propertyOptions=n.properties})()}fetchPositions(){var e=this;return(0,u.Z)(function*(){const n=yield e.positionsApi.getAllPositions();e.positionOptions=n.positions})()}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(m.F0),t.Y36(I.V),t.Y36(k.C),t.Y36(N.l),t.Y36(F.W),t.Y36(V._),t.Y36(w.m),t.Y36(L.U))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-create-talent"]],decls:17,vars:3,consts:[[1,"animated","fadeIn"],[1,"card","content-section-card"],[1,"card-body"],[1,"form-row","mb-2"],[1,"col"],[1,"col-auto","col-sm-4"],["title","Save list of talents",1,"btn","btn-block","btn-success",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-paper-plane","mr-1"],[4,"ngFor","ngForOf"],[1,"mt-2","mb-1","btn","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-plus","mr-1"],["savingInProcessModal",""],[1,"align-items-center","border","rounded","my-1","shadow-sm",3,"ngClass"],[1,"col","my-3"],[1,"form-row"],[1,"col-auto"],[1,"btn","btn-light","rounded-pill","text-center",3,"click"],[1,"m-0","p-0"],["aria-hidden","true",1,"fa",3,"ngClass"],[4,"ngIf"],["class","ml-1 d-inline-block text-success",4,"ngIf"],[1,"col-12","col-sm-auto","text-right"],["class","btn btn-sm btn-outline-danger","title","Remove this entry",3,"click",4,"ngIf"],["class","btn btn-link","target","_blank",3,"routerLink",4,"ngIf"],[1,"pt-2",3,"collapse","isAnimated"],["id","formError","class","p-error block",4,"ngIf"],["id","generalInfoSection"],[1,"mb-0"],[3,"disabled","allNationalities","allLanguages","touchForm","valueChanges","statusChanges"],["id","legacyWorkSection",3,"collapse","isAnimated"],[1,"my-2"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[3,"disabled","positionOptions","propertyOptions","touchForm","valueChanges","statusChanges",4,"ngIf"],["id","accountSection",3,"collapse","isAnimated"],[3,"disabled","touchForm","canCreateRoles","valueChanges","statusChanges",4,"ngIf"],["id","sectionsControl","class","mt-2",4,"ngIf"],["class","mx-1",4,"ngIf"],[1,"mx-1"],["accentLevel","warning","iconClasses","fa fa-exclamation-circle","tooltipMessage","This talent form has not been completed yet"],[1,"ml-1","d-inline-block","text-success"],["aria-hidden","true",1,"fa","fa-check","mr-1"],["title","Remove this entry",1,"btn","btn-sm","btn-outline-danger",3,"click"],["aria-hidden","true",1,"fa","fa-minus","mr-1"],["target","_blank",1,"btn","btn-link",3,"routerLink"],["id","formError",1,"p-error","block"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["aria-hidden","true",1,"fa","fa-briefcase","mr-1"],[3,"disabled","positionOptions","propertyOptions","touchForm","valueChanges","statusChanges"],["aria-hidden","true",1,"fa","fa-door-closed","mr-1"],[3,"disabled","touchForm","canCreateRoles","valueChanges","statusChanges"],["id","sectionsControl",1,"mt-2"],["class","btn btn-sm btn-outline-primary mr-1",3,"click",4,"ngIf"],["class","btn btn-sm btn-outline-primary",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-primary","mr-1",3,"click"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],["aria-hidden","true",1,"fa","fa-door-open","mr-1"],["savingResource","talent",3,"progress","close"],["class","my-2 p-1",4,"ngIf"],[1,"my-2","p-1"],[1,"list-group","list-group-flush","mb-2"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],["target","_blank",3,"routerLink"]],template:function(n,s){if(1&n){const r=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4"),t._uU(6,"New talents"),t.qZA()(),t.TgZ(7,"div",5)(8,"button",6),t.NdJ("click",function(){t.CHM(r);const _=t.MAs(16);return t.KtG(s.saveTalents(_))}),t._UZ(9,"i",7),t._uU(10),t.qZA()()(),t.YNc(11,et,35,32,"div",8),t.TgZ(12,"button",9),t.NdJ("click",function(){return s.addNewRow()}),t._UZ(13,"i",10),t._uU(14,"Add a new entry "),t.qZA()()()(),t.YNc(15,st,2,2,"ng-template",null,11,t.W1O)}2&n&&(t.xp6(8),t.Q6J("disabled",0==s.inputTalentForms.length),t.xp6(2),t.hij("Save talents (",s.inputTalentForms.length-s.savedTalents.length,") "),t.xp6(1),t.Q6J("ngForOf",s.inputTalentForms))},dependencies:[m.rH,d.mk,d.sg,d.O5,g.Y,p.n,J.s,E.V,M.g,U.e],encapsulation:2})}return a})();var rt=o(2342),lt=o(3920);let ct=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[m.Bz.forChild([{path:"",component:ot}]),d.ez,C.UX,g.f,A.HC.forRoot(),b.z8,y.t,Z.k,x.B,rt.M,lt.y]})}return a})()}}]);