"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[267],{2962:(S,g,s)=>{s.d(g,{s:()=>v});var a=s(1571),r=s(6895),R=s(2320);const m=function(o){return["badge","badge-pill",o]};let v=(()=>{class o{constructor(){this.accentLevel="",this.iconClasses="",this.tooltipMessage="",this.placement="auto"}ngOnInit(){}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=a.Xpm({type:o,selectors:[["app-shared-icon-tooltip"]],inputs:{accentLevel:"accentLevel",iconClasses:"iconClasses",tooltipMessage:"tooltipMessage",placement:"placement"},decls:4,vars:6,consts:[[1,"it-icon-wrapper",3,"tooltip","placement"],[1,"it-one-to-one","it-aspect-ratio"],[1,"it-icon",3,"ngClass"],["aria-hidden","true",3,"ngClass"]],template:function(n,d){1&n&&(a.TgZ(0,"span",0),a._UZ(1,"div",1),a.TgZ(2,"div",2),a._UZ(3,"i",3),a.qZA()()),2&n&&(a.Q6J("tooltip",d.tooltipMessage)("placement",d.placement),a.xp6(2),a.Q6J("ngClass",a.VKq(4,m,"badge-"+d.accentLevel)),a.xp6(1),a.Q6J("ngClass",d.iconClasses))},dependencies:[r.mk,R.i9],styles:[".it-icon-wrapper[_ngcontent-%COMP%]{display:inline-block;position:relative;width:1rem;vertical-align:text-bottom}.it-icon-wrapper[_ngcontent-%COMP%]   .it-one-to-one.it-aspect-ratio[_ngcontent-%COMP%]{padding-bottom:100%}.it-icon-wrapper[_ngcontent-%COMP%]   .it-icon[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;justify-content:center;align-items:center}"]})}return o})()},9147:(S,g,s)=>{s.d(g,{Ib:()=>_,Vg:()=>o,ub:()=>f});var a=s(3905),r=s(4004),R=s(2340),m=s(1571),v=s(529),o=(()=>{return(n=o||(o={}))[n.CANDIDATE=0]="CANDIDATE",n[n.CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED=1]="CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED",n[n.CANDIDATE_ENDED_NOT_DESIRED=2]="CANDIDATE_ENDED_NOT_DESIRED",n[n.ACTIVE=10]="ACTIVE",n[n.ENDED=19]="ENDED",n[n.CHANGE_PROMOTION=20]="CHANGE_PROMOTION",n[n.CHANGE_LATERAL_MOVEMENT=21]="CHANGE_LATERAL_MOVEMENT",n[n.CHANGE_TRANSFER_SAME_POSITION=22]="CHANGE_TRANSFER_SAME_POSITION",n[n.CHANGE_TRANSFER_PROMOTION=23]="CHANGE_TRANSFER_PROMOTION",n[n.DISMISSAL_VOLUNTARY_ABSENTEEISM=50]="DISMISSAL_VOLUNTARY_ABSENTEEISM",n[n.DISMISSAL_VOLUNTARY_ABANDONMENT=51]="DISMISSAL_VOLUNTARY_ABANDONMENT",n[n.DISMISSAL_VOLUNTARY_RETIREMENT=52]="DISMISSAL_VOLUNTARY_RETIREMENT",n[n.DISMISSAL_VOLUNTARY_BETTER_OFFER=53]="DISMISSAL_VOLUNTARY_BETTER_OFFER",n[n.DISMISSAL_VOLUNTARY_PERSONAL=54]="DISMISSAL_VOLUNTARY_PERSONAL",n[n.DISMISSAL_FORCED_END_OF_CONTRACT=70]="DISMISSAL_FORCED_END_OF_CONTRACT",n[n.DISMISSAL_FORCED_DISEASE=71]="DISMISSAL_FORCED_DISEASE",n[n.DISMISSAL_FORCED_DEATH=72]="DISMISSAL_FORCED_DEATH",n[n.DISMISSAL_FORCED_LOW_PERFORMANCE=73]="DISMISSAL_FORCED_LOW_PERFORMANCE",n[n.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS=74]="DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS",n[n.DISMISSAL_FORCED_OTHERS=75]="DISMISSAL_FORCED_OTHERS",o;var n})();class f{static#e=this.changesReasons=[o.CHANGE_PROMOTION,o.CHANGE_LATERAL_MOVEMENT,o.CHANGE_TRANSFER_SAME_POSITION,o.CHANGE_TRANSFER_PROMOTION];static#t=this.voluntaryDismissalReasons=[o.DISMISSAL_VOLUNTARY_ABSENTEEISM,o.DISMISSAL_VOLUNTARY_ABANDONMENT,o.DISMISSAL_VOLUNTARY_RETIREMENT,o.DISMISSAL_VOLUNTARY_BETTER_OFFER,o.DISMISSAL_VOLUNTARY_PERSONAL];static#i=this.forcedDismissalReasons=[o.DISMISSAL_FORCED_END_OF_CONTRACT,o.DISMISSAL_FORCED_DISEASE,o.DISMISSAL_FORCED_DEATH,o.DISMISSAL_FORCED_LOW_PERFORMANCE,o.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS,o.DISMISSAL_FORCED_OTHERS];static#n=this.allDismissalReasons=[...this.voluntaryDismissalReasons,...this.forcedDismissalReasons];static#s=this.statusNameMap=new Map([[o.CANDIDATE,"Candidate"],[o.CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED,"Candidate ended but not selected"],[o.CANDIDATE_ENDED_NOT_DESIRED,"Candidate not desired"],[o.ACTIVE,"Active"],[o.ENDED,"Ended"],[o.CHANGE_PROMOTION,"Promotion"],[o.CHANGE_LATERAL_MOVEMENT,"Lateral movement"],[o.CHANGE_TRANSFER_SAME_POSITION,"Transfer same position"],[o.CHANGE_TRANSFER_PROMOTION,"Transfer promotion"],[o.DISMISSAL_VOLUNTARY_ABSENTEEISM,"Absenteeism"],[o.DISMISSAL_VOLUNTARY_ABANDONMENT,"Abandonment"],[o.DISMISSAL_VOLUNTARY_RETIREMENT,"Retirement"],[o.DISMISSAL_VOLUNTARY_BETTER_OFFER,"Better offer"],[o.DISMISSAL_VOLUNTARY_PERSONAL,"Personal"],[o.DISMISSAL_FORCED_END_OF_CONTRACT,"End of contract"],[o.DISMISSAL_FORCED_DISEASE,"Disease"],[o.DISMISSAL_FORCED_DEATH,"Death"],[o.DISMISSAL_FORCED_LOW_PERFORMANCE,"Low performance"],[o.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS,"Inapropiate behaviors"],[o.DISMISSAL_FORCED_OTHERS,"Other"]])}let _=(()=>{class n{constructor(i){this.http=i,this.serverUrl=R.N.v2apiServer}static formatDates(i){return{...i,...i.from?{from:new Date(i.from)}:{},...i.until?{until:new Date(i.until)}:{}}}createEmploymentRecord(i,p,u,I,e){return(0,a.z)(this.http.post(this.serverUrl+"employment/",{job:i,talent:p,status:u,from:I.toISOString(),...e?{allowMultiple:e}:{}}).pipe((0,r.U)(O=>n.formatDates(O))))}getActiveEmploymentForTalent(i){return(0,a.z)(this.http.get(this.serverUrl+"employment/active/"+i).pipe((0,r.U)(p=>p?n.formatDates(p):null)))}getRelevantEmploymentForReview(i,p){return(0,a.z)(this.http.get(this.serverUrl+"employment/relevant/"+i+"/"+p).pipe((0,r.U)(u=>u?n.formatDates(u):null)))}getEmploymentsForTalent(i){return(0,a.z)(this.http.get(this.serverUrl+"employment/talent/"+i).pipe((0,r.U)(p=>p.map(u=>n.formatDates(u)))))}editEmployment(i,p,u,I,e){return(0,a.z)(this.http.put(this.serverUrl+"employment/"+i,{from:p.toISOString(),...void 0!==u?{status:u}:{},...void 0!==I?{until:I}:{},...void 0!==e?{notes:e}:{}}).pipe((0,r.U)(O=>n.formatDates(O))))}endEmployment(i,p,u,I){return(0,a.z)(this.http.put(this.serverUrl+"team/end-employment/"+i,{status:p,until:u.toISOString(),...I?{notes:I}:{}}).pipe((0,r.U)(e=>n.formatDates(e))))}static#e=this.\u0275fac=function(p){return new(p||n)(m.LFG(v.eN))};static#t=this.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},4954:(S,g,s)=>{s.d(g,{m:()=>_});var a=s(3905),r=s(4004),R=s(262),m=s(2340),v=s(2027),o=s(1571),f=s(529);let _=(()=>{class n{constructor(i){this.http=i,this.serverUrl=m.N.apiServer,this.serverV2Url=m.N.v2apiServer}findReviewWindows(){return this.http.get(this.serverUrl+"window").pipe((0,r.U)(i=>({reviewWindows:i.windows})),(0,R.K)(i=>(console.error(i.error),[])))}getProgressBarStats(i,p){return(0,a.z)(this.http.put(this.serverV2Url+"statistics/progress-bar/"+i,p).pipe((0,r.U)(u=>({...u,reviewCycle:n.formatDates(u.reviewCycle)}))))}getTalentMapStats(i,p){return(0,a.z)(this.http.put(this.serverV2Url+"statistics/talent-map/"+i,p).pipe(u=>u))}static formatDates(i){if(i)return{...i,...i.startDate?{startDate:new v.p({ISODateString:i.startDate})}:{},...i.endDate?{endDate:new v.p({ISODateString:i.endDate})}:{}}}getAllReviewCycles(){return(0,a.z)(this.http.get(this.serverV2Url+"review-cycle").pipe((0,r.U)(i=>({reviewCycles:i.map(p=>n.formatDates(p))}))))}getCurrentReviewCycle(){return(0,a.z)(this.http.get(this.serverV2Url+"review-cycle/current").pipe((0,r.U)(i=>({reviewCycle:n.formatDates(i)}))))}createReviewCycle(i){return(0,a.z)(this.http.post(this.serverV2Url+"review-cycle",{...i.name?{name:i.name}:{},...i.startDate?{startDate:i.startDate}:{},...i.endDate?{endDate:i.endDate}:{}}).pipe((0,r.U)(p=>n.formatDates(p))))}editReviewCycle(i){return(0,a.z)(this.http.put(this.serverV2Url+"review-cycle/"+i._id,{...i.name?{name:i.name}:{},...i.startDate?{startDate:i.startDate}:{},...i.endDate?{endDate:i.endDate}:{}}).pipe((0,r.U)(p=>n.formatDates(p))))}deleteReviewCycle(i){return(0,a.z)(this.http.delete(this.serverV2Url+"review-cycle/"+i).pipe((0,r.U)(p=>p)))}static#e=this.\u0275fac=function(p){return new(p||n)(o.LFG(f.eN))};static#t=this.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},8254:(S,g,s)=>{s.d(g,{M:()=>o});var a=s(3905),r=s(4004),R=s(2340),m=s(1571),v=s(529);let o=(()=>{class f{constructor(n){this.http=n,this.serverUrl=R.N.v2apiServer}getBoxes(){return(0,a.z)(this.http.get(this.serverUrl+"talent-map-box").pipe((0,r.U)(n=>({boxes:n.sort((d,i)=>d.pos-i.pos)}))))}static#e=this.\u0275fac=function(d){return new(d||f)(m.LFG(v.eN))};static#t=this.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},4053:(S,g,s)=>{s.d(g,{U:()=>f});var a=s(3905),r=s(4004),R=s(2340),m=s(9147),v=s(1571),o=s(529);let f=(()=>{class _{constructor(d){this.http=d,this.serverUrl=R.N.v2apiServer}getTeamByLeader(d){return(0,a.z)(this.http.get(this.serverUrl+"team/"+d).pipe((0,r.U)(i=>({...i,...i.employment?{employment:m.Ib.formatDates(i.employment)}:{},teamMembers:i.teamMembers.map(p=>({...p,...p.employment?{employment:m.Ib.formatDates(p.employment)}:{}}))}))))}getRelevantJobByTalent(d){return(0,a.z)(this.http.get(this.serverUrl+"team/relevant-job/"+d).pipe((0,r.U)(i=>i)))}getTopMostJobInHierarchy(){return(0,a.z)(this.http.get(this.serverUrl+"team/top-most-job/").pipe((0,r.U)(d=>d)))}addJobEmployment(d,i,p,u){return(0,a.z)(this.http.post(this.serverUrl+"team/new-job-employment",{title:void 0,property:d,position:i,talent:p,from:u}).pipe((0,r.U)(I=>I)))}addEndedEmployment(d,i,p,u,I,e,O){return(0,a.z)(this.http.post(this.serverUrl+"team/ended-employment",{title:void 0,leaderJob:void 0,property:d,position:i,talent:p,status:u,from:I,until:e,...O?{notes:O}:{}}).pipe((0,r.U)(y=>y)))}addJob(d,i,p){return(0,a.z)(this.http.post(this.serverUrl+"job/",{leader:d,property:i,position:p}).pipe((0,r.U)(u=>u)))}removeJob(d){return(0,a.z)(this.http.delete(this.serverUrl+"job/"+d).pipe((0,r.U)(i=>i)))}getOwnActiveResponsibiliy(){return(0,a.z)(this.http.get(this.serverUrl+"team/active-responsibility/").pipe((0,r.U)(d=>d)))}static#e=this.\u0275fac=function(i){return new(i||_)(v.LFG(o.eN))};static#t=this.\u0275prov=v.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},2497:(S,g,s)=>{s.r(g),s.d(g,{CreateReviewModule:()=>me});var a=s(6895),r=s(433),R=s(2714),m=s(8816),v=s(4175),o=s(2306),f=s(5861),_=s(1831),n=s(727),d=s(2027),i=s(826),p=s(1658),u=s(582),I=s(625),e=s(1571),O=s(921),y=s(8254),V=s(9147),Y=s(9559),G=s(4053),J=s(171),K=s(2733),j=s(4954),F=s(1740),Z=s(2210),H=s(2962);function W(l,A){if(1&l){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const h=e.oxw();return e.KtG(h.removeInvalidRows())}),e._UZ(1,"i",13),e._uU(2,"Remove invalid entries "),e.qZA()}}function Q(l,A){if(1&l){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const h=e.oxw(),D=e.MAs(14);return e.KtG(h.saveTalents(D))}),e._UZ(1,"i",15),e._uU(2),e.qZA()}if(2&l){const t=e.oxw();e.Q6J("disabled",0===t.talentsToReview.length||t.talentsToReview.length-t.invalidRowsNumber()-t.savedRowsNumber()==0),e.xp6(2),e.hij("Save Reviews (",t.talentsToReview.length-t.invalidRowsNumber()-t.savedRowsNumber(),") ")}}function z(l,A){if(1&l){const t=e.EpF();e.TgZ(0,"div",19)(1,"p",20),e._uU(2,"No talents currently selected"),e.qZA(),e.TgZ(3,"button",21),e.NdJ("click",function(){e.CHM(t);const h=e.oxw(2);return e.KtG(h.goToTalentFinder())}),e._uU(4,"Select talents in Talent Finder"),e.qZA()()}}function k(l,A){1&l&&(e.TgZ(0,"div",19)(1,"div",22)(2,"span",23),e._uU(3,"Loading..."),e.qZA()()())}function $(l,A){if(1&l&&(e.TgZ(0,"div",16),e.YNc(1,z,5,0,"div",17),e.YNc(2,k,4,0,"ng-template",null,18,e.W1O),e.qZA()),2&l){const t=e.MAs(3),c=e.oxw();e.xp6(1),e.Q6J("ngIf",!c.isLoading)("ngIfElse",t)}}function X(l,A){if(1&l&&(e.TgZ(0,"span",58),e._UZ(1,"app-shared-icon-tooltip",59),e.qZA()),2&l){const t=e.oxw(2).$implicit;e.xp6(1),e.s9C("tooltipMessage",t.formGroup.errors.notSaved.message)}}function q(l,A){if(1&l&&(e.TgZ(0,"span"),e.YNc(1,X,2,1,"span",57),e.qZA()),2&l){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.formGroup.errors)}}function ee(l,A){1&l&&(e.TgZ(0,"span",60),e._UZ(1,"i",61),e._uU(2," Talent has not been assigned to the hierarchy "),e.qZA())}const te=function(l,A){return{"btn-outline-danger":l,"btn-danger":A}};function ie(l,A){if(1&l){const t=e.EpF();e.TgZ(0,"button",62),e.NdJ("click",function(){e.CHM(t);const h=e.oxw().$implicit,D=e.oxw(2);return e.KtG(D.removeRow(h))}),e._UZ(1,"i",13),e._uU(2,"Remove entry "),e.qZA()}if(2&l){const t=e.oxw().$implicit,c=e.oxw(2);e.Q6J("ngClass",e.WLB(1,te,!c.isInvalidForm(t),c.isInvalidForm(t)))}}function ne(l,A){if(1&l&&(e.TgZ(0,"p",33)(1,"strong",63),e._uU(2,"Position:"),e.qZA(),e._uU(3),e.qZA()),2&l){const t=e.oxw().$implicit;e.xp6(3),e.hij("",t.talentInfo.position," ")}}function se(l,A){if(1&l&&(e.TgZ(0,"p",33)(1,"strong",63),e._uU(2,"Property:"),e.qZA(),e._uU(3),e.qZA()),2&l){const t=e.oxw().$implicit;e.xp6(3),e.hij("",t.talentInfo.property," ")}}function oe(l,A){if(1&l&&(e.TgZ(0,"span",65),e._uU(1),e.qZA()),2&l){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.formGroup.errors.notSaved.message," ")}}function ae(l,A){if(1&l&&(e.TgZ(0,"span",31),e.YNc(1,oe,2,1,"span",64),e.qZA()),2&l){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.formGroup.errors)}}const re=function(l){return{"border-danger":l}},le=function(l,A){return{"fa-chevron-up":l,"fa-chevron-down":A}},ce=function(l){return["/","app","talent","view",l]};function de(l,A){if(1&l){const t=e.EpF();e.TgZ(0,"div",28)(1,"div",29)(2,"div",30)(3,"div",31)(4,"div",5)(5,"button",32),e.NdJ("click",function(){const D=e.CHM(t).$implicit;return e.KtG(D.formVisible=!D.formVisible)}),e.TgZ(6,"h6",33),e._UZ(7,"i",34),e.qZA()()(),e.TgZ(8,"div",4)(9,"h6",35),e._uU(10),e.qZA(),e.YNc(11,q,2,1,"span",36),e.TgZ(12,"span",37),e.YNc(13,ee,3,0,"span",38),e.qZA()(),e.TgZ(14,"div",39)(15,"a",40),e._uU(16," View talent "),e.qZA(),e.YNc(17,ie,3,4,"button",41),e.qZA()(),e.TgZ(18,"div",42)(19,"div",31)(20,"div",43),e.YNc(21,ne,4,1,"p",44),e.YNc(22,se,4,1,"p",44),e.qZA(),e.TgZ(23,"div",45)(24,"form",46)(25,"div",47)(26,"div",48)(27,"label",49),e._uU(28,"Performance Score"),e.qZA(),e.TgZ(29,"div",50),e._UZ(30,"input",51),e.qZA(),e.TgZ(31,"small",52),e._uU(32),e.qZA()(),e.TgZ(33,"div",48)(34,"label",53),e._uU(35,"Potential Score"),e.qZA(),e.TgZ(36,"div",50),e._UZ(37,"p-dropdown",54),e.qZA(),e.TgZ(38,"small",55),e._uU(39),e.qZA()()()()()(),e.YNc(40,ae,2,1,"span",56),e.qZA()()()()}if(2&l){const t=A.$implicit,c=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(26,re,t.formGroup.touched&&t.formGroup.errors)),e.xp6(4),e.Udp("font-size",100,"%"),e.xp6(2),e.Q6J("ngClass",e.WLB(28,le,t.formVisible,!t.formVisible)),e.xp6(3),e.AsE("",t.talentInfo.talentName.given," ",t.talentInfo.talentName.last,""),e.xp6(1),e.Q6J("ngIf",!t.formVisible),e.xp6(2),e.Q6J("ngIf",!t.talentInfo.activeEmploymentId),e.xp6(2),e.Q6J("routerLink",e.VKq(31,ce,t.talentInfo.talentId)),e.xp6(2),e.Q6J("ngIf",!t.saved),e.xp6(1),e.Q6J("collapse",!t.formVisible)("isAnimated",!0),e.xp6(3),e.Q6J("ngIf",t.talentInfo.position),e.xp6(1),e.Q6J("ngIf",t.talentInfo.property),e.xp6(2),e.Q6J("formGroup",t.formGroup),e.xp6(6),e.hYB("placeholder","",c.reviewValidRanges.per.min+1," - ",c.reviewValidRanges.per.max,"%"),e.xp6(1),e.Q6J("collapse",!c.isFormError("performanceScore",t))("isAnimated",!0),e.xp6(1),e.hij(" ",c.prettifyError(t.formGroup.controls.performanceScore.errors)," "),e.xp6(5),e.Q6J("autoDisplayFirst",!1)("options",c.potentialRanges),e.xp6(1),e.Q6J("collapse",!c.isFormError("potentialScore",t))("isAnimated",!0),e.xp6(1),e.hij(" ",c.prettifyError(t.formGroup.controls.potentialScore.errors)," "),e.xp6(1),e.Q6J("ngIf",t.formVisible)}}function pe(l,A){if(1&l&&(e.TgZ(0,"div",24)(1,"div",25)(2,"p",26),e._uU(3,"Currently adding reviews for the review cycle: "),e.TgZ(4,"b"),e._uU(5),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.qZA()(),e.YNc(9,de,41,33,"div",27),e.qZA()),2&l){const t=e.oxw();e.xp6(5),e.Oqu(null==t.currentReviewCycle?null:t.currentReviewCycle.name),e.xp6(1),e.hij(" on ",t.today,"."),e.xp6(2),e.hij("The last day for adding reviews in the current cycle is: ",null==t.currentReviewCycle?null:t.currentReviewCycle.endDate,"."),e.xp6(1),e.Q6J("ngForOf",t.talentsToReview)}}function _e(l,A){if(1&l){const t=e.EpF();e.TgZ(0,"bulk-save-progress-modal",66),e.NdJ("close",function(){e.CHM(t);const h=e.oxw();return e.KtG(h.closeProgressModal())}),e.qZA()}if(2&l){const t=e.oxw();e.Q6J("progress",t.savingProgress)}}class ve{constructor(A,t,c,h,D,w){this.formVisible=!0,this.hasReview=!1,this.canAddReview=!1,this.isEmployed=!1,this.saved=!1,this.talentInfo=A,this.formGroup=t,this.hasReview=c,this.canAddReview=h,this.isEmployed=D,void 0!==w&&(this.assignedEvDefinition=w)}setReviewValues(){this.formGroup.markAllAsTouched(),this.formReviewValue={performanceScore:this.formGroup.get("performanceScore")?.value,potentialScore:this.formGroup.get("potentialScore")?.value}}}let he=(()=>{class l{constructor(t,c,h,D,w,fe,Ee,Ae,Re,ge,Ie){var E=this;this.router=t,this.fb=c,this.sessionStateService=h,this.store=D,this.talentMapBoxService=w,this.employmentService=fe,this.reviewService=Ee,this.teamService=Ae,this.authStateService=Re,this.modalService=ge,this.reviewCycleServiceApi=Ie,this.today=new d.p,this.talentsToReview=[],this.talentsToReviewQueue=[],this.savingProgress=new u.j(0),this.potentialRanges=[{value:1,display:"Low"},{value:2,display:"Medium"},{value:3,display:"High"}],this.reviewValidRanges={per:{min:0,max:0},pot:{min:0,max:0}},this.subscriptions=new n.w0,this.isLoading=!1,this.evaluationResponse={},this.evaluationDefinitionsList=[],this.talentManagement$=D.pipe((0,_.Ys)("talentManagementState")),this.getBoxesInfo(),this.subscriptions.add(this.authStateService.authState.subscribe(function(){var L=(0,f.Z)(function*(M){M.identity&&(E.currentUser=M.identity)});return function(M){return L.apply(this,arguments)}}())),this.subscriptions.add(this.talentManagement$.subscribe(function(){var L=(0,f.Z)(function*(M){if(M.selectedTalents.length>0&&(E.isLoading=!0),E.currentReviewCycle=(yield E.reviewCycleServiceApi.getCurrentReviewCycle()).reviewCycle,void 0!==E.currentReviewCycle){if(E.activeResponsibilities=yield E.teamService.getOwnActiveResponsibiliy(),M.selectedTalents.length>0){const Te=M.selectedTalents.map(U=>U.talentId);yield E.reviewService.obtainEvaluationDefinitionForTalents(Te).then(U=>{if(E.evaluationResponse=U,void 0!==E.evaluationResponse.employments&&E.evaluationResponse.employments?.length>0)for(const T of E.evaluationResponse.employments){let x,B,N=!0,b=!1,C=T.isEmployed;x={talentId:T.talent?._id,talentName:T.talent?.name,...C?{position:T.job?.position?.name}:{},...C?{positionId:T.job?.position?._id}:{},...C?{property:T.job?.property?.name}:{},...C?{propertyId:T.job?.property?._id}:{},...C&&!T.isLegacy?{activeEmploymentId:T._id}:{}},T.job?.position?.evaluationFormId&&(B=T.job?.position?.evaluationFormId),C&&(N=E.canAddReview(x.propertyId,x.talentId));let P=E.fb.group({performanceScore:[{value:null,disabled:!N||b||!C},[r.kI.required,p.d.isInteger(),r.kI.min(E.reviewValidRanges.per.min+1),r.kI.max(E.reviewValidRanges.per.max)]],potentialScore:[{value:null,disabled:!N||b||!C},[r.kI.required,p.d.isInteger(),r.kI.min(E.reviewValidRanges.pot.min),r.kI.max(E.reviewValidRanges.pot.max)]]});N?C||P.setErrors({notSaved:{message:"Cannot add review to this talent: Talent is not currently employed"}}):P.setErrors({notSaved:{message:"Cannot add review to this talent: You lack the permissions to add a review to this talent"}});let De=new ve(x,P,b,N,C,B);E.talentsToReview.push(De)}if(void 0!==E.evaluationResponse.evaluationDefinitions&&E.evaluationResponse.evaluationDefinitions?.length>0)for(const T of E.evaluationResponse.evaluationDefinitions)E.evaluationDefinitionsList.push(T.id)})}E.isLoading=!1}else alert("Seems there is no active review cycle.")});return function(M){return L.apply(this,arguments)}}()))}ngOnDestroy(){this.store.dispatch((0,i.XA)()),this.subscriptions.unsubscribe()}isInvalidForm(t){return t.hasReview||!t.canAddReview||!t.isEmployed}canSaveReview(t){return!t.saved&&!this.isInvalidForm(t)}canAddReview(t,c){let h=this.activeResponsibilities?.activeJob?this.activeResponsibilities?.activeJob.property._id:this.currentUser?.talent?.location;switch(this.currentUser?.role){case I.u.SUPER_ADMIN:case I.u.ADMIN:return!0;case I.u.MANAGER:return h===t;case I.u.EMPLOYEE:return h===t&&this.currentUser.id!==c;default:return!1}}invalidRowsNumber(){return this.talentsToReview.filter(t=>this.isInvalidForm(t)).length}savedRowsNumber(){return this.talentsToReview.filter(t=>t.saved).length}isFormError(t,c){const h=c.formGroup.get(t);return!h?.pristine&&!h?.valid}prettifyError(t){return t?t.required?"Required":t.min||t.max?"Invalid":t.notNumeric?"Not number":t.notInteger?"Contains decimal":"":""}goToTalentFinder(){this.router.navigate(["app","talent","finder"])}removeRow(t){this.sessionStateService.registerActivity();const c=this.talentsToReview.indexOf(t);this.talentsToReview.splice(c,1)}removeInvalidRows(){this.talentsToReview=this.talentsToReview.filter(t=>t.canAddReview&&!t.hasReview&&t.isEmployed)}saveNextTalent(){if(0==this.talentsToReviewQueue.length)return void(this.talentsToReviewQueue=[]);const t=this.talentsToReviewQueue.shift();let c=this.talentsToReview.findIndex(h=>h.talentInfo.talentId===t?.talentInfo.talentId);void 0!==t&&(t.formGroup.valid&&this.currentReviewCycle?this.saveValidReview(t,this.currentReviewCycle._id).then(()=>{this.savingProgress.incrementSuccessful(),this.talentsToReview[c].formGroup.disable(),this.talentsToReview[c].formVisible=!1,this.talentsToReview[c].formGroup.setErrors(null),this.talentsToReview[c].saved=!0,this.saveNextTalent()}).catch(h=>{this.savingProgress.incrementFailed(),this.talentsToReview[c].formGroup.setErrors({notSaved:{message:h.message.message}}),this.saveNextTalent()}):(this.savingProgress.incrementFailed(),this.talentsToReview[c].formGroup.setErrors({notSaved:{message:"This form is invalid or hasn't been completed"}}),this.saveNextTalent()))}saveValidReview(t,c){let h={potential:t.formReviewValue?.potentialScore,performance:t.formReviewValue?.performanceScore,date:this.today.date,reviewCycle:c,talent:t.talentInfo.talentId,...t.talentInfo.activeEmploymentId?{employment:t.talentInfo.activeEmploymentId}:{}};return this.reviewService.addTalentReview(h)}getBoxesInfo(){this.talentMapBoxService.getBoxes().then(t=>{t.boxes.length>0&&(this.reviewValidRanges={per:{max:t.boxes.find(c=>8===c.pos)?.perRng.high||100,min:t.boxes.find(c=>0===c.pos)?.perRng.low||0},pot:{max:t.boxes.find(c=>0===c.pos)?.potRng.high||3,min:t.boxes.find(c=>8===c.pos)?.potRng.low||0}})})}saveTalents(t){this.sessionStateService.registerActivity(),this.talentsToReviewQueue=this.talentsToReview.filter(c=>this.canSaveReview(c)).map(c=>(c.setReviewValues(),c)),this.savingProgress=new u.j(this.talentsToReviewQueue.length),this.modalService.openModal(t,{ignoreBackdropClick:!0,keyboard:!1}),this.saveNextTalent()}closeProgressModal(){this.sessionStateService.registerActivity(),this.modalService.closeUpperModal()}static#e=this.\u0275fac=function(c){return new(c||l)(e.Y36(R.F0),e.Y36(r.QS),e.Y36(O.W),e.Y36(_.yh),e.Y36(y.M),e.Y36(V.Ib),e.Y36(Y.f),e.Y36(G.U),e.Y36(J.V),e.Y36(K.l),e.Y36(j.m))};static#t=this.\u0275cmp=e.Xpm({type:l,selectors:[["app-create-review"]],decls:15,vars:4,consts:[[1,"animated","fadeIn"],[1,"card","content-section-card"],[1,"card-body"],[1,"form-row","mb-2"],[1,"col"],[1,"col-auto"],["class","btn btn-block btn-danger","title","Remove invalid entries",3,"click",4,"ngIf"],[1,"col-auto","col-sm-4"],["class","btn btn-block btn-success","title","Save reviews for talents",3,"disabled","click",4,"ngIf"],["class","row",4,"ngIf"],["class","row px-3",4,"ngIf"],["savingInProcessModal",""],["title","Remove invalid entries",1,"btn","btn-block","btn-danger",3,"click"],["aria-hidden","true",1,"fa","fa-minus","mr-1"],["title","Save reviews for talents",1,"btn","btn-block","btn-success",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-paper-plane","mr-1"],[1,"row"],["class","col text-center",4,"ngIf","ngIfElse"],["loadingMessage",""],[1,"col","text-center"],[1,"mb-1"],[1,"btn","btn-block","btn-primary",3,"click"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"row","px-3"],["role","alert",1,"col-12","alert","alert-info"],[1,"py-2","m-0"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"row","align-items-center","border","border-secondary","shadow-sm","rounded","py-2","my-1",3,"ngClass"],[1,"col","my-2"],[1,"form-row"],[1,"btn","btn-light","rounded-pill","text-center",3,"click"],[1,"m-0","p-0"],["aria-hidden","true",1,"fa",3,"ngClass"],[1,"d-inline"],[4,"ngIf"],[1,"ml-3"],["class","mx-1 ml-2 text-warning",4,"ngIf"],[1,"col-12","col-sm-auto","text-right"],["target","_blank",1,"btn","btn-link",3,"routerLink"],["title","Remove this entry","class","btn btn-sm",3,"ngClass","click",4,"ngIf"],[1,"pt-2",3,"collapse","isAnimated"],[1,"col-12","col-md-6","col-lg-4","d-flex","justify-content-center","flex-column"],["class","m-0 p-0",4,"ngIf"],[1,"col-12","col-md-6","col-lg-8"],["autocomplete","off",3,"formGroup"],[1,"form-row","align-items-center"],[1,"col-12","col-sm-6","col-md-6"],["for","performanceScore",1,"block","mb-0"],[1,"p-fluid"],["pInputText","","formControlName","performanceScore","id","performanceScore","name","performanceScore","aria-describedby","performanceInvalid","autocomplete","off","type","number",3,"placeholder"],["id","performanceInvalid",1,"p-error","block",3,"collapse","isAnimated"],["for","potentialScore",1,"block","mb-0"],["formControlName","potentialScore","placeholder","Select Potential","optionLabel","display","optionValue","value",3,"autoDisplayFirst","options"],["id","potentialInvalid",1,"p-error","block",3,"collapse","isAnimated"],["class","form-row",4,"ngIf"],["class","mx-1",4,"ngIf"],[1,"mx-1"],["accentLevel","danger","iconClasses","fa fa-exclamation-circle",3,"tooltipMessage"],[1,"mx-1","ml-2","text-warning"],["aria-hidden","true",1,"fa","fa-info-circle","mr-1","text-warning"],["title","Remove this entry",1,"btn","btn-sm",3,"ngClass","click"],[1,"pr-1"],["class","mt-3 text-danger",4,"ngIf"],[1,"mt-3","text-danger"],["savingResource","review",3,"progress","close"]],template:function(c,h){1&c&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4"),e._uU(6,"Add Reviews"),e.qZA()(),e.TgZ(7,"div",5),e.YNc(8,W,3,0,"button",6),e.qZA(),e.TgZ(9,"div",7),e.YNc(10,Q,3,2,"button",8),e.qZA()(),e.YNc(11,$,4,2,"div",9),e.YNc(12,pe,10,4,"div",10),e.qZA()()(),e.YNc(13,_e,1,1,"ng-template",null,11,e.W1O)),2&c&&(e.xp6(8),e.Q6J("ngIf",h.invalidRowsNumber()>0),e.xp6(2),e.Q6J("ngIf",h.talentsToReview.length),e.xp6(1),e.Q6J("ngIf",!h.talentsToReview.length),e.xp6(1),e.Q6J("ngIf",h.talentsToReview.length))},dependencies:[R.rH,a.mk,a.sg,a.O5,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u,m.Y,F.o,Z.Lt,u.n,H.s],encapsulation:2})}return l})();var ue=s(3345);let me=(()=>{class l{static#e=this.\u0275fac=function(c){return new(c||l)};static#t=this.\u0275mod=e.oAB({type:l});static#i=this.\u0275inj=e.cJS({imports:[R.Bz.forChild([{path:"",component:he}]),a.ez,r.UX,v.HC.forRoot(),m.f,F.j,Z.kW,o.t,ue.k]})}return l})()},9550:(S,g,s)=>{s.d(g,{F:()=>r});var a=s(5861);class r{constructor(m,v,o=(0,a.Z)(function*(){return"default"})){this.thisArg=m,this._cachedResponseMap=new Map,this._serviceOperation=v,this._cacheKeyMapper=o}get(...m){var v=this;return(0,a.Z)(function*(){const o=yield v._cacheKeyMapper.apply(v.thisArg,m);let f=v._cachedResponseMap.get(o);return void 0===f&&(f=yield v._serviceOperation.apply(v.thisArg,m),v._cachedResponseMap.set(o,f)),f})()}clear(...m){var v=this;return(0,a.Z)(function*(){if(m&&m.length){const o=yield v._cacheKeyMapper.apply(v.thisArg,m);v._cachedResponseMap.delete(o)}else v._cachedResponseMap.clear()})()}}},8816:(S,g,s)=>{s.d(g,{Y:()=>o,f:()=>f});var a=s(7340),r=s(1571);const R="400ms cubic-bezier(0.4,0.0,0.2,1)",m=[(0,a.oB)({height:0,visibility:"hidden"}),(0,a.jt)(R,(0,a.oB)({height:"*",visibility:"visible"}))],v=[(0,a.oB)({height:"*",visibility:"visible"}),(0,a.jt)(R,(0,a.oB)({height:0,visibility:"hidden"}))];let o=(()=>{class _{constructor(d,i,p){this._el=d,this._renderer=i,this.collapsed=new r.vpe,this.collapses=new r.vpe,this.expanded=new r.vpe,this.expands=new r.vpe,this.isExpanded=!0,this.collapseNewValue=!0,this.isCollapsed=!1,this.isCollapse=!0,this.isCollapsing=!1,this.isAnimated=!1,this._display="block",this._stylesLoaded=!1,this._COLLAPSE_ACTION_NAME="collapse",this._EXPAND_ACTION_NAME="expand",this._factoryCollapseAnimation=p.build(v),this._factoryExpandAnimation=p.build(m)}set display(d){this._display=d,"none"!==d?this.isAnimated?this.toggle():this.show():this.hide()}set collapse(d){this.collapseNewValue=d,(!this._player||this._isAnimationDone)&&(this.isExpanded=d,this.toggle())}get collapse(){return this.isExpanded}ngAfterViewChecked(){this._stylesLoaded=!0,this._player&&this._isAnimationDone&&(this._player.reset(),this._renderer.setStyle(this._el.nativeElement,"height","*"))}toggle(){this.isExpanded?this.hide():this.show()}hide(){this.isCollapsing=!0,this.isExpanded=!1,this.isCollapsed=!0,this.isCollapsing=!1,this.collapses.emit(this),this._isAnimationDone=!1,this.animationRun(this.isAnimated,this._COLLAPSE_ACTION_NAME)(()=>{this._isAnimationDone=!0,this.collapseNewValue!==this.isCollapsed&&this.isAnimated?this.show():(this.collapsed.emit(this),this._renderer.setStyle(this._el.nativeElement,"display","none"))})}show(){this._renderer.setStyle(this._el.nativeElement,"display",this._display),this.isCollapsing=!0,this.isExpanded=!0,this.isCollapsed=!1,this.isCollapsing=!1,this.expands.emit(this),this._isAnimationDone=!1,this.animationRun(this.isAnimated,this._EXPAND_ACTION_NAME)(()=>{this._isAnimationDone=!0,this.collapseNewValue!==this.isCollapsed&&this.isAnimated?this.hide():(this.expanded.emit(this),this._renderer.removeStyle(this._el.nativeElement,"overflow"))})}animationRun(d,i){if(!d||!this._stylesLoaded)return u=>u();this._renderer.setStyle(this._el.nativeElement,"overflow","hidden"),this._renderer.addClass(this._el.nativeElement,"collapse");const p=i===this._EXPAND_ACTION_NAME?this._factoryExpandAnimation:this._factoryCollapseAnimation;return this._player&&this._player.reset(),this._player=p.create(this._el.nativeElement),this._player.play(),u=>this._player?.onDone(u)}}return _.\u0275fac=function(d){return new(d||_)(r.Y36(r.SBq),r.Y36(r.Qsj),r.Y36(a._j))},_.\u0275dir=r.lG2({type:_,selectors:[["","collapse",""]],hostVars:9,hostBindings:function(d,i){2&d&&(r.uIk("aria-hidden",i.isCollapsed),r.ekj("collapse",i.isCollapse)("in",i.isExpanded)("show",i.isExpanded)("collapsing",i.isCollapsing))},inputs:{display:"display",isAnimated:"isAnimated",collapse:"collapse"},outputs:{collapsed:"collapsed",collapses:"collapses",expanded:"expanded",expands:"expands"},exportAs:["bs-collapse"]}),_})(),f=(()=>{class _{static forRoot(){return{ngModule:_,providers:[]}}}return _.\u0275fac=function(d){return new(d||_)},_.\u0275mod=r.oAB({type:_}),_.\u0275inj=r.cJS({}),_})()},1740:(S,g,s)=>{s.d(g,{j:()=>v,o:()=>m});var a=s(1571),r=s(6895),R=s(433);let m=(()=>{class o{constructor(_,n,d){this.el=_,this.ngModel=n,this.cd=d}ngAfterViewInit(){this.updateFilledState(),this.cd.detectChanges()}ngDoCheck(){this.updateFilledState()}onInput(_){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length||this.ngModel&&this.ngModel.model}}return o.\u0275fac=function(_){return new(_||o)(a.Y36(a.SBq),a.Y36(R.On,8),a.Y36(a.sBO))},o.\u0275dir=a.lG2({type:o,selectors:[["","pInputText",""]],hostAttrs:[1,"p-inputtext","p-component","p-element"],hostVars:2,hostBindings:function(_,n){1&_&&a.NdJ("input",function(i){return n.onInput(i)}),2&_&&a.ekj("p-filled",n.filled)}}),o})(),v=(()=>{class o{}return o.\u0275fac=function(_){return new(_||o)},o.\u0275mod=a.oAB({type:o}),o.\u0275inj=a.cJS({imports:[r.ez]}),o})()}}]);